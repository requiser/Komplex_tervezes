\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Keep aspect ratio if custom image width or height is specified
    \setkeys{Gin}{keepaspectratio}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{soul}      % strikethrough (\st) support for pandoc >= 3.0.0
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}


    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{notebook}
    
    
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@ges}{\let\PY@bf=\textbf\let\PY@it=\textit}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \section{Bevezetés}\label{bevezetuxe9s}

    A szakdolgozatom célja, hogy a klasszikus idősor-elemzési módszereket
ötvözve a modern természetes nyelvfeldolgozás (NLP) eszköztárával, új
megközelítést kínáljak a részvényárfolyamok előrejelzésére. A
részvénypiacok mozgásának előrejelzése mindig is kihívást jelentett,
mivel azok volatilitását számos tényező befolyásolja, legyen szó
makrogazdasági eseményekről, vállalati hírekről vagy akár a befektetők
érzelmeiről. Az elmúlt években a mesterséges intelligencia, különösen az
NLP fejlődése új kapukat nyitott meg a pénzügyi adatelemzésben, lehetővé
téve a piacot befolyásoló hírek és szöveges tartalmak automatizált
feldolgozását és értelmezését.

A részvényárak előrejelzésére hagyományosan alkalmazott technikai
elemzés számszerű múltbeli adatokra épít. Ugyanakkor a kutatások
rámutattak, hogy a kizárólag technikai elemzésre támaszkodó
megközelítések nem mindig vezetnek kielégítő eredményekhez, különösen a
befektetői érzelmek és a hírek hatásának figyelmen kívül hagyása miatt.
A pénzügyi hírek szöveges tartalmának elemzése azonban értékes
információkat nyújthat, amelyeket kiegészítve a numerikus adatokkal
pontosabb előrejelzések érhetők el.

A szakdolgozatom keretében különös figyelmet fordítok a BERT
(Bidirectional Encoder Representations from Transformers) modell alapú
NLP technikákra, amelyek lehetővé teszik a pénzügyi hírek és közlemények
precíz elemzését. Az idősor-elemzés hagyományos statisztikai modelljeit
pedig viszonyítási alapként használom a kísérleti eredmények
kiértékeléséhez.

Informatikusként hiszem, hogy a mesterséges intelligencia és az NLP
integrációja a pénzügyi elemzésbe nemcsak a befektetési döntések
gyorsaságát és pontosságát javíthatja, hanem hozzájárulhat a piacok
átláthatóságához is. Ezért választottam a részvényárfolyamok
előrejelzését az NLP módszereinek segítségével szakdolgozatom témájának,
hiszen ez egy olyan terület, amely az innováció és a technológiai
fejlődés határmezsgyéjén helyezkedik el. Az elvégzett kutatás reményeim
szerint új perspektívát nyújthat a pénzügyi elemzések világában, és
hozzájárulhat a befektetési döntéshozatal hatékonyságának növeléséhez.

    \section{Elméleti háttér}\label{elmuxe9leti-huxe1ttuxe9r}

    \subsection{Idősor-elemzés alapjai}\label{idux151sor-elemzuxe9s-alapjai}

Az idősor-elemzés az időben egymást követő adatok elemzésének tudománya,
amelyet gyakran alkalmaznak a pénzügyben, gazdasági előrejelzések
készítésében, meteorológiában és számos más tudományágban. Egy idősor
elemzése során az a cél, hogy azonosítsuk a megfigyelt mintázatokat,
megértjük azok struktúráját, és előrejelezzük a jövőbeli értékeket. Az
idősorok megértéséhez elengedhetetlen a trendek, szezonális komponensek
és véletlen zajok azonosítása és elemzése.

    \subsubsection{Az idősorok
jellemzői}\label{az-idux151sorok-jellemzux151i}

Az idősorok különböző összetevői az adatok dinamikus viselkedését
tükrözik. Ezek megértése kulcsfontosságú a helyes modellalkotáshoz és
előrejelzéshez.

\paragraph{\texorpdfstring{Trend
(\(T_t\))}{Trend (T\_t)}}\label{trend-t_t}

A trend az idősor hosszú távú irányultságát jelenti, amely lehet
növekvő, csökkenő vagy stagnáló. Például egy GDP-alapú gazdasági
előrejelzés lehet alapul tapasztalható növekedési trendre mutat.

Matematikailag a trendet egyszerű lineáris formában is leírhatjuk:

\[T_t = \beta_0 + \beta_1 t\]

ahol \(\beta_0\) az idősor kezdeti értéke, \(\beta_1\) pedig a növekedés
sebességét jelenti. Amennyiben a növekedés nem lineáris, polinomiális
formát alkalmazhatunk:

\[T_t = \beta_0 + \beta_1 t + \beta_2 t^2\]

A trendek azonosítása és modellezése kulcsfontosságú, mivel a véletlen
idősor viselkedése gyakran rejt maga a rövid távú ingadozások mellett.

\paragraph{\texorpdfstring{Szezonalitás
(\(S_t\))}{Szezonalitás (S\_t)}}\label{szezonalituxe1s-s_t}

A szezonalitás az adatok rendszeresen ismétlődő mintázatát jelenti,
amelyet tipikusan az évszakok, hónapok vagy napok okoznak. Például a
kiskereskedelmi forgalomban a decemberi hónap kiemelt értékeket mutat az
ünnepi vásárlások miatt.

A szezonalitás matematikai leírása gyakran trigonometrikus függvényekkel
történik:

\[S_t = A \sin\left(\frac{2\pi t}{P}\right) + B \cos\left(\frac{2\pi t}{P}\right)\]

ahol \(A\) és \(B\) az amplitúdók, \(P\) pedig a periódus. A szezonális
hatások felismerése érdekében sokszor grafikus módszereket alkalmazunk,
például a szezonális bontást, amely az idősor komponensekre bontását
célozza.

\paragraph{\texorpdfstring{Ciklikusság
(\(C_t\))}{Ciklikusság (C\_t)}}\label{ciklikussuxe1g-c_t}

A ciklikus komponensek az idősorban hosszabb időközönként visszatérő
mintázatokat jelentenek, amelyek nem feltétlenül szabályos időközönként
ismétlődnek. A gazdasági ciklusok például ilyen ciklikus jelenségek.

Egy ciklus azonosítása érdekében gyakran az autokorrelációs függvényt
(ACF) használják. Az autokorrelációs függvény az idősor múltbeli
értékeit és az aktuális értékeit közötti kapcsolatot vizsgálja, és segít
az ismétlődő minták detektálásában.

\paragraph{\texorpdfstring{Véletlen zaj
(\(\epsilon_t\))}{Véletlen zaj (\textbackslash epsilon\_t)}}\label{vuxe9letlen-zaj-epsilon_t}

A véletlen zaj az idősor azon komponense, amely nem magyarázható a fent
említett összetevők egyikével sem. Ez a rész véletlen fluktuációkat
tartalmaz, amelyeket gyakran normális eloszlásúnak feltételezünk, az
alábbi alakban:

\[\epsilon_t \sim \mathcal{N}(0, \sigma^2)\]

ahol \(\sigma^2\) a zaj varianciája. A véletlen zaj figyelembevétele
különösen fontos a modellépítés során, mivel a tüzött zaj
``tüllesztett'' eredményekhez, ami rontja az előrejelzések pontosságát.

    \subsubsection{Idősorok
stacionaritása}\label{idux151sorok-stacionarituxe1sa}

A stacionaritás az idősor statisztikai tulajdonságainak állandóságát
jelenti időben. Ez az elemzési feladat ellengedhetetlen az olyan
klasszikus modellek alkalmazásához, mint az ARIMA.

\paragraph{Matematikai definíció}\label{matematikai-definuxedciuxf3}

Egy idősor \(\{Y_t\}\) stacioner, ha: * Az idősor várható értéke
konstans: \(\mathbb{E}[Y_t] = \mu\) * Az idősor varianciája állandó:
\(\text{Var}[Y_t] = \sigma^2\) * Az idősor autokorrelációja csak az
időeltolódástól függ: \(\text{Cov}[Y_t, Y_{t-k}] = \gamma(k)\).

Ha az idősor nem stacioner, a modellezés előtt gyakran differenciálást
alkalmazunk:

\[\Delta Y_t = Y_t - Y_{t-1}\]

A differenciálás során a trend eltávolítható, és az idősor
stacionáriussá tehető.

\paragraph{Stacionaritás
tesztelése}\label{stacionarituxe1s-teszteluxe9se}

Különböző statisztikai tesztek használatosak a stacionaritás
ellenőrzésére:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Augmented Dickey-Fuller (ADF) teszt: Ez a teszt a nullhipotézisként
  feltételezi, hogy az idősor nem stacioner. A p-érték alapján
  eldönthető, hogy elutasítjuk-e a hipotézist.
\item
  Kwiatkowski-Phillips-Schmidt-Shin (KPSS) teszt: Ez a teszt a
  stacionaritást vizsgálja mint nullhipotézist, és ellenőrzést ad arra,
  hogy az idősor tartalmaz-e trendkomponenseket.
\end{enumerate}

    \subsubsection{Idősor-elemzési
modellek}\label{idux151sor-elemzuxe9si-modellek}

\paragraph{Mozgóátlag modellek (MA)}\label{mozguxf3uxe1tlag-modellek-ma}

A mozgóátlag modellek a múltbeli hibák súlyozott átlagára alapján
becsülik meg az idősor aktuális értékét. Egy \(q\)-rendű MA modell
általános formája:

\[Y_t = \mu + \epsilon_t + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + \cdots + \theta_q \epsilon_{t-q}\]

ahol \(\mu\) az idősor átlaga, \(\theta_i\) pedig a múltbeli hibák
súlyai.

\paragraph{Autoregresszív modellek
(AR)}\label{autoregresszuxedv-modellek-ar}

Az autoregresszív modellek az idősor jövőbeli értékét a múltbeli értékek
lineáris kombinációjaként becsülik meg. Egy \(p\)-rendű AR(\(p\)) modell
matematikai formája a következőképpen írható fel:

\[Y_t = \phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \cdots + \phi_p Y_{t-p} + \epsilon_t\]

ahol: * \(Y_t\) az idősor aktuális értéke, *
\(\phi_1, \phi_2, \ldots, \phi_p\) a múltbeli értékek súlyai
(autoregressziós paraméterek), * \(\epsilon_t\) a véletlen zaj, amely
\(\epsilon_t \sim \mathcal{N}(0, \sigma^2)\) feltételezéssel írunk le.

\subparagraph{Az autoregresszív modellek
tulajdonságai:}\label{az-autoregresszuxedv-modellek-tulajdonsuxe1gai}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Lineáris előrejelzés: Az AR(\(p\)) modell a múltbeli értékek egyenes
  arányban befolyásolják a jövőt. A súlyok nagysága és előjele
  meghatározza, hogy az egyes múltbeli értékek mennyire erősen és milyen
  irányban hatnak az aktuális értékre.
\item
  Rend (\(p\)) meghatározása: Az autoregresszív modell rendjét az adatok
  viselkedésének és az autokorrelációs függvény (ACF) elemzésével
  határozhatjuk meg. Az ACF megmutatja, hogy az idősor korábbi értékei
  hogyan függnek össze a korábbi értékekkel.
\item
  Stacionaritási követelmény: Az AR(\(p\)) modellek csak akkor működnek
  helyesen, ha az idősor stacioner. Az AR-paraméterek abszolútértékének
  összege egy adott feltétel szerint korlátozott:
\end{enumerate}

\[\sum_{i=1}^p |\phi_i| < 1\]

\subparagraph{Példa egy AR(1)
modellre:}\label{puxe9lda-egy-ar1-modellre}

Egy \(p = 1\)-rendű autoregresszív modell (AR(1)) a legegyszerűbb forma,
amely a következőként írható fel:

\[Y_t = \phi_1 Y_{t-1} + \epsilon_t\]

Ebben az esetben az aktuális érték kizárólag az előző időpont értékétől
függ. Ha \(\phi_1 > 0\), akkor a múltbeli értékek pozitívan korrelálnak
az aktuális értékkel, míg \(\phi_1 < 0\) esetén a kapcsolat inverz.

Rendben, itt vannak a képek konvertálva Markdown formátumba:

\paragraph{ARIMA modellek}\label{arima-modellek}

Az Autoregresszív Integrált Mozgóátlag (ARIMA) modellek az idősor
elemzésének és előrejelzésének széles körben alkalmazott eszközei. Az
ARIMA modellek az autoregressziót (AR), a differenciálást (I) és a
mozgóátlagot (MA) kombinálják.

\subparagraph{Az ARIMA modell általános
formája}\label{az-arima-modell-uxe1ltaluxe1nos-formuxe1ja}

Az ARIMA modell matematikai egyenlete így írható fel:

\[\Phi_p(B)(1 - B)^dY_t = \Theta_q(B)\epsilon_t\]

ahol: * \(\Phi_p(B) = 1 - \phi_1 B - \phi_2 B^2 - \cdots - \phi_p B^p\)
az autoregresszív komponens, * \((1 - B)^d\) az integrálási
(differenciálási) operátor a trend eltávolítására, *
\(\Theta_q(B) = 1 + \theta_1 B + \theta_2 B^2 + \cdots + \theta_q B^q\)
a mozgóátlag komponens, * \(B\) az eltoló operátor, amelyet
\(Y_t = Y_{t-1}\) definícióval használunk.

\subparagraph{\texorpdfstring{Paraméterek \((p, d, q)\)
jelentése}{Paraméterek (p, d, q) jelentése}}\label{paramuxe9terek-p-d-q-jelentuxe9se}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \(p\) - autoregresszív (AR) komponens rendje: Az idősor aktuális
  értékét a múltbeli értékek száma alapján becsüli.
\item
  \(d\) - differenciálás mértéke: Az idősor stacionaritását biztosító
  differenciálások száma.
\item
  \(q\) - mozgóátlag (MA) komponens rendje: Az idősor aktuális értékét a
  múltbeli hibák alapján becsüli.
\end{enumerate}

\subparagraph{Az ARIMA modellépítés
lépései}\label{az-arima-modelluxe9puxedtuxe9s-luxe9puxe9sei}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Adatok stacionaritásának vizsgálata: Augmented Dickey-Fuller (ADF)
  teszttel ellenőrizzük, hogy az idősor stacioner-e. Ha nem,
  differenciálást végzünk.
\item
  Paraméterek meghatározása: Az ACF és a parciális autokorrelációs
  függvény (PACF) elemzésével meghatározzuk az optimális \(p, d\) és
  \(q\) értékeket.
\item
  Modell illesztése: A kapott paraméterek alapján felépítjük az ARIMA
  modellt.
\item
  Diagnosztikai vizsgálat: A modell maradékai (reziduálisokat)
  vizsgáljuk, hogy megfelelnek-e a fehér zaj tulajdonságainak.
\end{enumerate}

\paragraph{SARIMA modellek}\label{sarima-modellek}

A SARIMA modellek az ARIMA kiterjesztett változatai, amelyek a
szezonális mintázatokat is kezelik. Az általános modell neve: Szezonális
Autoregresszív Integrált Mozgóátlag.

\subparagraph{SARIMA modell általános
formája}\label{sarima-modell-uxe1ltaluxe1nos-formuxe1ja}

\[\Phi_p(B)\Phi_P(B^s)(1 - B)^d(1 - B^s)^DY_t = \Theta_q(B)\Theta_Q(B^s)\epsilon_t\]

ahol: * \(\Phi_P(B^s)\) és \(\Theta_Q(B^s)\) a szezonális AR és MA
komponensek, * \(D\) a szezonális differenciálás mértéke, * \(s\) a
szezonális periódus.

A SARIMA modellek különösen alkalmasak az olyan idősorokra, amelyek
egyaránt tartalmaznak trendeket és szezonális mintázatokat, például havi
eladási adatokra.

    \subsubsection{Természetes nyelvfeldolgozás
(NLP)}\label{termuxe9szetes-nyelvfeldolgozuxe1s-nlp}

\paragraph{NLP alapfogalmak és
technikák}\label{nlp-alapfogalmak-uxe9s-technikuxe1k}

A természetes nyelvfeldolgozás (Natural Language Processing, NLP) az a
terület, amelynek célja az emberi nyelv számítógépes feldolgozása és
megértése. Az NLP a mesterséges intelligencia feladatkörében helyezkedik
el, és olyan feladatokat old meg, mint a szövegelemzés, gépi fordítás,
nyelgenerálás és beszédfelismerés.

\subparagraph{Előfeldolgozási
lépések}\label{elux151feldolgozuxe1si-luxe9puxe9sek}

Az NLP folyamatának első lépése az adat előkészítése, amely
kulcsfontosságú a pontos elemzéshez és modellépítéshez. Az alábbi
lépéseket tartalmazza:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Tokenizálás: A szöveget kisebb egységekre, úgynevezett tokenekre
  bontjuk, amelyek lehetnek szavak, számok vagy egyéb jelek. Például:
  ``Ez'', ``egy'', ``példa''. A tokenizálás alapvető célja, hogy az
  elemzések számára strukturált adatokat biztosítson.
\item
  Lemmatizálás és szótövezés: Ezek az eljárások a szavakat az
  alapformájukra redukálják. A lemmatizálás figyelembe veszi a szavak
  nyelvtani szerepét, míg a szótövezés (stemming) egyszerű egygyökű
  szabályokat használ. Például a ``futott'', ``futva'' és ``futás''
  szavakat a ``fut'' alapformára hozza.
\item
  Stop szavak eltávolítása: Az olyan gyakori szavak, mint ``a'', ``ez'',
  ``vagy'', ``is'', általában nem hordoznak értékes információt, így
  ezeket gyakran kiszűrik az elemzés során.
\item
  Zajszűrés: A szövegből az irreleváns karakterek, jelek eltávolítják az
  elemzés során.
\end{enumerate}

\subparagraph{Szövegreprezentációs
módszerek}\label{szuxf6vegreprezentuxe1ciuxf3s-muxf3dszerek}

Az NLP modelljei számára a nyelvi adatok számok formájában történő
megjelenítése szükséges. Az alábbiakban néhány elterjed módszert
ismertetünk:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Bag of Words (BoW): A szöveget szavak halmazaként reprezentálja, ahol
  az egyes szavak előfordulásának gyakorisága rögzíti. Hátránya, hogy
  figyelmen kívül hagyja a szavak sorrendjét és kontextusát.
\item
  Term Frequency-Inverse Document Frequency (TF-IDF): Ez a módszer a
  szavak relatív fontosságát méri egy dokumentumban, figyelembe véve,
  hogy egy adott szó milyen gyakran fordul elő az összes dokumentumban.
  A TF-IDF képlete:
\end{enumerate}

\[\text{TF-IDF}(t, d, D) = \text{TF}(t, d) \times \text{IDF}(t, D)\]

ahol: * \(\text{TF}(t, d)\): a \(t\) szó gyakorisága a \(d\)
dokumentumban, *
\(\text{IDF}(t, D) = \log \frac{|D|}{1 + |\{d \in D : t \in d\}|}\): az
inverz dokumentumfrekvencia.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\item
  Word embeddings (Word2Vec, GloVe): Ezek a módszerek a szavak sűrű
  vektorreprezentációját állítják elő, amely figyelembe veszi a szavak
  kontextusát és hasonlóságát. A Word2Vec például a szavak n-dimenziós
  térben történő elhelyezésével nyeri ki a szavak vektori közötti
  kapcsolatokat.
\item
  Kontextuális embeddings (BERT, GPT): Ezek az új generációs modellek
  nemcsak a szavak jelentését veszik figyelembe, hanem azok környezetét
  is. A BERT (Bidirectional Encoder Representations from Transformers)
  például pontosabb kontextusba ágyazott szóvektorokat biztosít.
\end{enumerate}

\subparagraph{Szemantikai elemzés}\label{szemantikai-elemzuxe9s}

Az NLP-ben a szemantikai elemzés az emberi nyelv jelentésének feltárását
célozza. Az alábbiakban a legfontosabb alkalmazásokat ismertetjük:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Sentiment analízis: Ez a technika a szöveg érzelmi tónusának (pozitív,
  semleges, negatív) azonosítására irányul. Alkalmazása elterjed a
  közösségi médiaelemzésekben és a vásárlói visszajelzések
  feldolgozásában.
\item
  Névelem-felismerés (NER): A szövegben szereplő entitások (személyek,
  helyek, dátumok) automatikus felismerése és osztályozása. Például egy
  ``Google'' entitást vállalatként azonosítja.
\item
  Témamodellezés: Az LDA (Latent Dirichlet Allocation) segítségével a
  szövegből különböző témák automatikus kinyerése valósítható meg. Az
  LDA feltételezi, hogy a dokumentumok kevert témákat tartalmaznak, és
  minden téma adott szavak halmazát reprezentálja.
\end{enumerate}

\paragraph{Modern NLP
architektúrák}\label{modern-nlp-architektuxfaruxe1k}

\subparagraph{Transformer
architektúra}\label{transformer-architektuxfara}

A Transformer modell a természetes nyelvfeldolgozás
forradalmiszemközének, amely figyfyelmi (self-attention) alapú. Az
architektúra alapegyenlete:

\[Attention(Q,K,V) = softmax(\frac{QK^T}{\sqrt{d_k}}),V\]

ahol: * Q: a lekérdezési mátrix (queries), * K: a kulcsok mátrixa
(keys), * V: az értékek mátrixa (values), * \(d_k\): a kulcsmátrix
dimenziója.

\subparagraph{Előtanított nyelvi
modellek}\label{elux151tanuxedtott-nyelvi-modellek}

A BERT (Bidirectional Encoder Representations from Transformers) az
evolúziót, mint például a FinBERT - jelentős szerepet játszanak a
pénzügyi szövegek feldolgozásában. A FinBERT + kifejezetten pénzügyi
adatokra finomhangolható, így hatékonyabb szentiméntelemzésre és
piacokkal kapcsolatos szövegek feldolgozására.

\subsubsection{Pénzügyi piacok
elemzése}\label{puxe9nzuxfcgyi-piacok-elemzuxe9se}

\paragraph{Piaci hatékonyság és
előrejelezhetőség}\label{piaci-hatuxe9konysuxe1g-uxe9s-elux151rejelezhetux151suxe9g}

A pénzügyi piacok hatékonysága és előrejelezhetősége kulcsfontosságú
kérdés a modern közgazdaságtanban és pénzügyi elemzésben. Az Efficient
Market Hypothesis (EMH), vagyis a hatékony piacok elmélete, Eugene Fama
nevéhez kötődik, aki 1970-ben alkotta meg az elmélet alapjait. Az
elmélet szerint a piacok olyan hatékonyak, hogy minden releváns
információ azonnal és teljes mértékben tükröződik az eszközök árában.

\subparagraph{Piaci hatékonyság
típusai}\label{piaci-hatuxe9konysuxe1g-tuxedpusai}

Az EMH három fő formát különböztet meg:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Gyenge forma: Ez azt állítja, hogy az árfolyamok csak a múltbeli
  adatokat és volumeneiket tükrözik. Ennek következménye, hogy a
  technikai elemzés nem nyújt előnyt az árba. Matematikailag szempontból
  a piaci árfolyamokat véletlenszerű (randomwalk) modellezzük:

  \[P_t = P_{t-1} + \epsilon_t\]

  ahol:

  \begin{itemize}
  \tightlist
  \item
    \(P_t\): az árfolyam t időpontban,
  \item
    \(\epsilon_t\): független és azonos eloszlású véletlen zaj.
  \end{itemize}
\item
  Közepes forma: Ez azt állítja, hogy az árfolyamok nemcsak a múltbeli
  adatokat, hanem az összes nyilvánosan elérhető információt is
  tartalmazzák. Ebben beletartoznak a vállalati jelentések, gazdasági
  hírek és politikai események. Ez az állítás megkérdőjelezi a
  fundamentális elemzés hatékonyságát.
\item
  Erős forma: Ez a forma állítja, hogy az árák minden információt
  tükröznek, beleértve a nyilvános és a bennfentes információkat is. Ha
  ez igaz lenne, senki sem tudna tartósan felülteljesíteni a piacot, még
  a bennfentes információk felhasználásával sem.
\end{enumerate}

\subparagraph{Piaci anomáliák}\label{piaci-anomuxe1liuxe1k}

Bár az EMH széles körben elfogadott, számos kutatás mutatott ki
anomáliákat, amelyek az elmélet gyengeségeire utalnak:

\begin{itemize}
\tightlist
\item
  Hét napja hatás: Bizonyos napokon (például pénteken) az árfolyamok
  szisztematikusan eltérnek az átlagtól.
\item
  Január hatás: Az év első hónapjában gyakran magasabb hozamok
  figyelhetők meg.
\item
  Bennfentes kereskedelem: A bennfentes információk használata előnyt
  jelenthet, különösen az erős formájú piacok esetében.
\end{itemize}

\subparagraph{Piaci szentiméntés és viselkedési
pénzügyek}\label{piaci-szentimuxe9ntuxe9s-uxe9s-viselkeduxe9si-puxe9nzuxfcgyek}

A piaci szentiméntés, vagyis a befektetők általános érzelmi állapota,
jelentős hatással van az árfolyamokra. A viselkedési pénzügyek
(behavioral finance) ezen hatásokat próbálja megérteni és modellezni.

\subparagraph{Befektetői hangulat
mérése}\label{befektetux151i-hangulat-muxe9ruxe9se}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Közvetlen mérési módszerek: A befektetők körében végzett felmérések és
  kérdőívek segítségével közvetlenül mérhetjük a piaci szentiméntet.
  Például az AAII Investor Sentiment Survey az amerikai befektetők
  optimizmusát és semlegességét méri.
\item
  Közvetett indikátorok: A piaci mutatók, például a VIX index
  (volatility index), a piaci kockázatvállalást és szentiméntet
  közvetett módon mérésére szolgálnak. Magas VIX-értékek jellemzően
  félelmet jeleznek a piacokon.
\item
  Média alapú szentiméntés: A hírek, közösségi média bejegyzések és
  pénzügyi elemzések automatikus szövegelemzése segítségével a piaci
  hangulat kvantitatív módon mérhető. Az NLP és szentiméntanalízis,
  például a FinBERT modell segítségével, fontos szerepet játszanak e
  folyamatban.
\end{enumerate}

\subparagraph{Viselkedési
torzítások}\label{viselkeduxe9si-torzuxedtuxe1sok}

A befektetők döntéseit gyakran irracionalitási tényezők befolyásolják,
amelyek torzítják a piacok működését:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Nyájhatás (herding effect): A befektetők hajlamosak mások viselkedését
  követni, különösen bizonytalan környezetben. Ez jelentős
  árfolyam-ingadozást okozhat.
\item
  Túlzott magabiztosság (overconfidence): A befektetők túlbecsülik saját
  tudásukat és képességeiket, ami gyakran túlzott kockázatvállaláshoz
  vezet.
\item
  Lehorgonyzás (anchoring): Az árfolyamok elemzése során az emberek
  gyakran túl nagy jelentőséget tulajdonítanak egy korábbi értéknek vagy
  eseménynek, ami befolyásolja döntéseiket.
\end{enumerate}

\subsubsection{Hibrid modellezési
megközelítések}\label{hibrid-modellezuxe9si-megkuxf6zeluxedtuxe9sek}

\paragraph{Idősoros és szöveges adatok
integrálása}\label{idux151soros-uxe9s-szuxf6veges-adatok-integruxe1luxe1sa}

A különböző adatforrások egyesítése a pénzügyi modellezés új dimenzióját
nyitja meg. Az idősorelemzés és az NLP együttes alkalmazása a
strukturált (árfolyamok) és strukturálatlan (szövegek) adatok
integrálására.

\subparagraph{Feature engineering}\label{feature-engineering}

Az adatokból kinyert jellemzők (features) alapvető szerepet játszanak az
integrált modellek teljesítményében:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Idősor jellemzők: Az idősorokból statisztikai mutatókat nyerhetünk ki,
  mint például a mozgóátlagok, volatilitás, maximumok és minimumok.
\item
  Szöveges jellemzők: A szentiméntanalízis eredményeit, a TF-IDF
  értékeket vagy a szóbeágyazásokat kombinálhatjuk az idősorokkal.
  Például egy hír szentiméntjét és a hozzá kapcsolódó árfolyamváltozást
  egyaránt modellezhetjük.
\item
  Jellemzők kombinálása: Az idősor- és szöveges jellemzők egyesítése
  lehetővé teszi a komplex összefüggések feltárását.
\end{enumerate}

\subparagraph{Modell architektúrák}\label{modell-architektuxfaruxe1k}

Az integrált adatelemzés különböző modellarchitektúrákat igényel:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Párhuzamos feldolgozás: Az idősor- és szöveges adatokat külön
  modellekben dolgozzák fel, majd az eredményeket kombinálják.
\item
  Kaszkád modellek: Az egyik modell eredményeit felhasználják egy másik
  modell számára.
\item
  Ensemble módszerek: Több modell eredményeinek kombinálásával növelhető
  az előrejelzések pontossága.
\end{enumerate}

\paragraph{Mély tanulási alapú
megoldások}\label{muxe9ly-tanuluxe1si-alapuxfa-megolduxe1sok}

A mélytanulási (Deep Learning) módszerek az utóbbi években
forradalmasították a pénzügyi előrejelzést és a természetes
nyelvfeldolgozást. Az idősorok és szöveges adatok integrációjában
különösen fontos szerepet játszanak az olyan modellek, amelyek képesek a
komplex, nemlineáris kapcsolatok azonosítására.

\subparagraph{Rekurrens neurális hálózatok
(RNN)}\label{rekurrens-neuruxe1lis-huxe1luxf3zatok-rnn}

Az RNN-ek alkalmasak az idősorok adatok modellezésére, mivel képesek
kezelni a függőségeket képesek kezelni. Az alap RNN-ek azonban hosszú
távú függőségekkel nem tudnak hatékonyan megbirkózni, ezért
fejlesztették ki a következő speciális változatokat:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  LSTM (Long Short-Term Memory): Az LSTM egységek képesek a hosszú távú
  függőségek kezelésére, mivel a memóriakap szabályozzák, hogy az
  információ hogyan áramlik a hálózaton keresztül:

  \[f_t = \sigma(W_f[h_{t-1}, x_t] + b_f),\quad i_t = \sigma(W_i[h_{t-1}, x_t] + b_i),\]

  ahol:

  \begin{itemize}
  \tightlist
  \item
    \(f_t\): felejtési kapu,
  \item
    \(i_t\): beviteli kapu,
  \item
    \(\sigma\): aktivációs függvény,
  \item
    \(W\) és \(b\): súlyok és bias paraméterek.
  \end{itemize}
\item
  GRU (Gated Recurrent Unit): A GRU egy egyszerűbb alternatíva az
  LSTM-hez, amely kevesebb paramétert használ. Gyakrabban tanulást
  biztosít.
\end{enumerate}

\subparagraph{Konvolúciós neurális hálózatok
(CNN)}\label{konvoluxfaciuxf3s-neuruxe1lis-huxe1luxf3zatok-cnn}

A CNN-ek hagyományosan képfeldolgozásra lettek kifejlesztve, de időbeli
mintázatok felismerésére is alkalmazhatók az idősor-elemzés során. A
konvolúciós rétegek képesek a rövid távú mintázatok (például időben
változások) azonosítására:

\[z_{i,j} = \sigma\left(\sum_{m,n} x_{i+m,j+n} \cdot w_{m,n} + b\right),\]

ahol: * \(x\): bementi adatok, * \(w\): konvolúciós súlyok, * \(b\):
bias, * \(\sigma\): aktivációs függvény.

\subparagraph{Hibrid modellek}\label{hibrid-modellek}

A CNN és RNN kombinációja lehetővé teszi az idősorok és szöveges adatok
egységes feldolgozását. A CNN-ek az időbeli mintázatokat, míg az LSTM
vagy GRU az időbeli függőségeket azonosítják.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  CNN-LSTM: A CNN-ek az idősorosadatok jellemzőinek kinyerésére, az LSTM
  pedig a hosszú távú kapcsolatok felismerésére használhatók. Ez
  különösen hasznos, ha az idősoradat-jellemzőket az
  árfolyam-előrejelzéshez kombinálják.
\item
  Attention mechanizmus: Az attention mechanizmus lehetővé teszi a
  modell számára, hogy az adatok releváns részeire fókuszáljon. Ez
  különösen hasznos, ha egy szöveg bizonyos része vagy egy időbeli
  árfolyammérték nagyobb jelentőséggel bír:

  \[Attention(Q,K,V) = softmax\left(\frac{QK^T}{\sqrt{d_k}}\right)V,\]

  ahol:

  \begin{itemize}
  \tightlist
  \item
    Q: lekérdezés (query) mátrix,
  \item
    K: kulcs (key) mátrix,
  \item
    V: érték (value) mátrix,
  \item
    \(d_k\): dimenzióméret.
  \end{itemize}
\item
  Transformer alapú megoldások: A Transformer architektúra önmagában is
  használható az idősorok és szöveges adatok elemzésére. A
  self-attention mechanizmus révén hatékonyan dolgozza fel az adatokat,
  és képes a hosszú távú kapcsolatok azonosítására is.
\end{enumerate}

\subsubsection{Teljesítményértékelés és
validáció}\label{teljesuxedtmuxe9nyuxe9rtuxe9keluxe9s-uxe9s-validuxe1ciuxf3}

\paragraph{Előrejelzési metrikák}\label{elux151rejelzuxe9si-metrikuxe1k}

A modellek értékelésére többféle mutató is alkalmazható, amelyek
lehetővé teszik a pontosság és a gyakorlati használhatóság megítélését.

\subparagraph{Statisztikai metrikák}\label{statisztikai-metrikuxe1k}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Mean Absolute Error (MAE): Az abszolút hibák átlaga, amely a modellek
  általános pontosságát méri:

  \[MAE = \frac{1}{n} \sum_{i=1}^n |y_i - \hat{y}_i|,\]

  ahol:

  \begin{itemize}
  \tightlist
  \item
    \(y_i\): valódi érték,
  \item
    \(\hat{y}_i\): előrejelzett érték.
  \end{itemize}
\item
  Root Mean Square Error (RMSE): Az RMSE nagyobb súlyt ad a nagyobb
  hibáknak, ezért jobbán kiemeli a modell nagyobb tévedéseit.

  \[RMSE = \sqrt{\frac{1}{n} \sum_{i=1}^n (y_i - \hat{y}_i)^2}.\]
\item
  Mean Absolute Percentage Error (MAPE): Az előrejelzési hibák relatív
  arányát méri:

  \[MAPE = \frac{1}{n} \sum_{i=1}^n \left|\frac{y_i - \hat{y}_i}{y_i}\right| \cdot 100.\]
\end{enumerate}

\subparagraph{Pénzügyi metrikák}\label{puxe9nzuxfcgyi-metrikuxe1k}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Sharpe-ráta: A hozam és kockázat arányát méri:

  \[S = \frac{\bar{R} - R_f}{\sigma},\]

  ahol:

  \begin{itemize}
  \tightlist
  \item
    \(\bar{R}\): portfólió átlaghozama,
  \item
    \(R_f\): kockázatmentes hozam,
  \item
    \(\sigma\): portfólió szórása.
  \end{itemize}
\item
  Maximum drawdown: A legnagyobb csökkenés egy csúcsról egy mélypontra:

  \[MDD = \frac{\text{Peak Value} - \text{Trough Value}}{\text{Peak Value}}.\]
\item
  Profit és veszteség (P\&L): Az előrejelzések alapján végrehajtott
  stratégiák nyereségességét méri.
\end{enumerate}

\subparagraph{Validációs
stratégiák}\label{validuxe1ciuxf3s-stratuxe9giuxe1k}

A model robusztusságának és megbízhatóságának tesztelése kritikus
fontosságú:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Időbeli keresztvalidáció: Az idősorosadatok időbeli függősége miatt
  hagyományos keresztvalidáció nem használható. Az időbeli
  keresztvalidáció lépései:

  \begin{itemize}
  \tightlist
  \item
    A múltbeli adatokból tanul a modell.
  \item
    A jövőbeli adatokon teszteli magát.
  \end{itemize}
\item
  Backtesting: A történeti szimulációk révén a modell előrejelzését
  valós pénzi adatok alapján tesztelik. Fontos figyelembe venni a
  tranzakciós költségeket és a piaci körülményeket.
\end{enumerate}

    \section{Fejlesztői Dokumentáció és
Implementáció}\label{fejlesztux151i-dokumentuxe1ciuxf3-uxe9s-implementuxe1ciuxf3}

    \subsection{Használt csomagok}\label{hasznuxe1lt-csomagok}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{backtrader} \PY{k}{as} \PY{n+nn}{bt}
\PY{k+kn}{import} \PY{n+nn}{quantstats}
\PY{k+kn}{import} \PY{n+nn}{yfinance} \PY{k}{as} \PY{n+nn}{yf}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{express} \PY{k}{as} \PY{n+nn}{px}
\PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{dates} \PY{k+kn}{import} \PY{n}{DateFormatter}
\PY{k+kn}{from} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{subplots} \PY{k+kn}{import} \PY{n}{make\PYZus{}subplots}
\PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{graph\PYZus{}objects} \PY{k}{as} \PY{n+nn}{go}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{from} \PY{n+nn}{tornado}\PY{n+nn}{.}\PY{n+nn}{test}\PY{n+nn}{.}\PY{n+nn}{concurrent\PYZus{}test} \PY{k+kn}{import} \PY{n}{MiscFutureTest}
\PY{k+kn}{from} \PY{n+nn}{transformers} \PY{k+kn}{import} \PY{n}{AutoTokenizer}
\PY{k+kn}{from} \PY{n+nn}{transformers} \PY{k+kn}{import} \PY{n}{AutoModelForSequenceClassification}
\PY{k+kn}{from} \PY{n+nn}{transformers} \PY{k+kn}{import} \PY{n}{pipeline}
\PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{special} \PY{k+kn}{import} \PY{n}{softmax}
\PY{k+kn}{from} \PY{n+nn}{tqdm}\PY{n+nn}{.}\PY{n+nn}{notebook} \PY{k+kn}{import} \PY{n}{tqdm}
\PY{k+kn}{import} \PY{n+nn}{ast}

\PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ggplot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsection{NLP modellek}\label{nlp-modellek}

    \subsubsection{DistilRoBERTa}\label{distilroberta}

A fine-tuned version of DistilRoberta base model on the Financial
PhraseBank dataset.

https://huggingface.co/mrm8488/distilroberta-finetuned-financial-news-sentiment-analysis

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model\PYZus{}DistRoBERTa} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mrm8488/distilroberta\PYZhy{}finetuned\PYZhy{}financial\PYZhy{}news\PYZhy{}sentiment\PYZhy{}analysis}\PY{l+s+s2}{\PYZdq{}}


\PY{n}{\PYZus{}sentiment\PYZus{}analysis\PYZus{}DistRoBERTa} \PY{o}{=} \PY{n}{pipeline}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sentiment\PYZhy{}analysis}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                           \PY{n}{model}\PY{o}{=} \PY{n}{AutoModelForSequenceClassification}\PY{o}{.}\PY{n}{from\PYZus{}pretrained}\PY{p}{(}
                                               \PY{n}{model\PYZus{}DistRoBERTa}\PY{p}{,}
                                               \PY{n}{num\PYZus{}labels}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}
                                           \PY{n}{tokenizer}\PY{o}{=}\PY{n}{AutoTokenizer}\PY{o}{.}\PY{n}{from\PYZus{}pretrained}\PY{p}{(}\PY{n}{model\PYZus{}DistRoBERTa}\PY{p}{)}\PY{p}{,}
                                           \PY{n}{top\PYZus{}k}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{padding}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{truncation}\PY{o}{=}\PY{k+kc}{True}
                                           \PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{FinBERT}\label{finbert}

A pre-traned NLP model to analyze sentiment of financial text. The BERT
model fine-tuned on the Financial PhraseBank dataset.

https://huggingface.co/ProsusAI/finbert

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model\PYZus{}FinBERT} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ProsusAI/finbert}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{\PYZus{}sentiment\PYZus{}analysis\PYZus{}FinBERT} \PY{o}{=} \PY{n}{pipeline}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sentiment\PYZhy{}analysis}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                       \PY{n}{model}\PY{o}{=}\PY{n}{AutoModelForSequenceClassification}\PY{o}{.}\PY{n}{from\PYZus{}pretrained}\PY{p}{(}
                                           \PY{n}{model\PYZus{}FinBERT}\PY{p}{,}
                                           \PY{n}{num\PYZus{}labels}\PY{o}{=}\PY{l+m+mi}{3}
                                       \PY{p}{)}\PY{p}{,}
                                       \PY{n}{tokenizer}\PY{o}{=}\PY{n}{AutoTokenizer}\PY{o}{.}\PY{n}{from\PYZus{}pretrained}\PY{p}{(}\PY{n}{model\PYZus{}FinBERT}\PY{p}{)}\PY{p}{,}
                                       \PY{n}{top\PYZus{}k}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{padding}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{truncation}\PY{o}{=}\PY{k+kc}{True}
                                       \PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{FinDeBERTa}\label{findeberta}

A fine-tuned version of DeBERTa base model on the None dataset.

https://huggingface.co/mrm8488/deberta-v3-ft-financial-news-sentiment-analysis

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{model\PYZus{}DeBERTa} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mrm8488/deberta\PYZhy{}v3\PYZhy{}ft\PYZhy{}financial\PYZhy{}news\PYZhy{}sentiment\PYZhy{}analysis}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{\PYZus{}sentiment\PYZus{}analysis\PYZus{}DeBERTa} \PY{o}{=} \PY{n}{pipeline}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sentiment\PYZhy{}analysis}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                       \PY{n}{model}\PY{o}{=}\PY{n}{AutoModelForSequenceClassification}\PY{o}{.}\PY{n}{from\PYZus{}pretrained}\PY{p}{(}
                                           \PY{n}{model\PYZus{}DeBERTa}\PY{p}{,}
                                           \PY{n}{num\PYZus{}labels}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}
                                       \PY{n}{tokenizer}\PY{o}{=}\PY{n}{AutoTokenizer}\PY{o}{.}\PY{n}{from\PYZus{}pretrained}\PY{p}{(}\PY{n}{model\PYZus{}DeBERTa}\PY{p}{)}\PY{p}{,}
                                       \PY{n}{top\PYZus{}k}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{padding}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsection{Függvények}\label{fuxfcggvuxe9nyek}

    \subsubsection{Adatok
előkészítése}\label{adatok-elux151kuxe9szuxedtuxe9se}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{preprocess\PYZus{}data}\PY{p}{(}\PY{n}{input\PYZus{}file}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Process stock data by combining news data with Yahoo Finance price data.}
\PY{l+s+sd}{    Missing stock data is filled using linear interpolation: i/(n+1) where n is the number}
\PY{l+s+sd}{    of missing days and i is the current position in the gap.}

\PY{l+s+sd}{    Parameters:}
\PY{l+s+sd}{    \PYZhy{} input\PYZus{}file: Path to the input CSV file containing news data}
\PY{l+s+sd}{    \PYZhy{} ticker: Ticker symbol of the stock}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{k}{try}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} Read the CSV file}
        \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{input\PYZus{}file}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Remove unnamed columns}
        \PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{contains}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unnamed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{case}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Filter data for specific ticker}
        \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{stock}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{ticker}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Convert date to datetime with UTC timezone}
        \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{utc}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Convert UTC time to local time and extract date}
        \PY{n}{local\PYZus{}dates} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{tz\PYZus{}localize}\PY{p}{(}\PY{k+kc}{None}\PY{p}{)}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{date}

        \PY{c+c1}{\PYZsh{} Create a datetime index for the news data}
        \PY{n}{news\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{local\PYZus{}dates}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ | }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
        \PY{n}{news\PYZus{}data}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{News}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Convert Date column to datetime without timezone}
        \PY{n}{news\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{news\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Get date range for stock data (using localized dates)}
        \PY{n}{start\PYZus{}date} \PY{o}{=} \PY{n}{local\PYZus{}dates}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}
        \PY{n}{end\PYZus{}date} \PY{o}{=} \PY{n}{local\PYZus{}dates}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Fetch stock data from Yahoo Finance}
        \PY{n}{stock} \PY{o}{=} \PY{n}{yf}\PY{o}{.}\PY{n}{download}\PY{p}{(}\PY{n}{ticker}\PY{p}{,} \PY{n}{start}\PY{o}{=}\PY{n}{start\PYZus{}date}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{n}{end\PYZus{}date}\PY{p}{,} \PY{n}{progress}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
        \PY{n}{stock} \PY{o}{=} \PY{n}{stock}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
        \PY{n}{stock}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{stock}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Yahoo data comes without timezone}

        \PY{c+c1}{\PYZsh{} Flatten multi\PYZhy{}level columns if they exist}
        \PY{n}{stock}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{n}{col}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{if} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n}{col}\PY{p}{,} \PY{n+nb}{tuple}\PY{p}{)} \PY{k}{else} \PY{n}{col} \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{stock}\PY{o}{.}\PY{n}{columns}\PY{p}{]}

        \PY{c+c1}{\PYZsh{} Create a complete date range including weekends}
        \PY{n}{date\PYZus{}range} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{date\PYZus{}range}\PY{p}{(}\PY{n}{start}\PY{o}{=}\PY{n}{start\PYZus{}date}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{n}{end\PYZus{}date}\PY{p}{,} \PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{complete\PYZus{}dates} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{date\PYZus{}range}\PY{p}{\PYZcb{}}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Merge stock data with complete date range}
        \PY{n}{stock\PYZus{}full} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{complete\PYZus{}dates}\PY{p}{,} \PY{n}{stock}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

        \PY{k}{def} \PY{n+nf}{interpolate\PYZus{}gaps}\PY{p}{(}\PY{n}{series}\PY{p}{)}\PY{p}{:}
\PY{+w}{            }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{            Custom interpolation function that uses i/(n+1) formula for gaps}
\PY{l+s+sd}{            \PYZdq{}\PYZdq{}\PYZdq{}}
            \PY{n}{result} \PY{o}{=} \PY{n}{series}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
            \PY{n}{mask} \PY{o}{=} \PY{n}{series}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}

            \PY{k}{if} \PY{o+ow}{not} \PY{n}{mask}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{} No NaNs to fill}
                \PY{k}{return} \PY{n}{result}

            \PY{c+c1}{\PYZsh{} Find consecutive NaN sequences}
            \PY{n}{gaps} \PY{o}{=} \PY{n}{mask}\PY{o}{.}\PY{n}{ne}\PY{p}{(}\PY{n}{mask}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{n}{mask}\PY{p}{]}

            \PY{k}{for} \PY{n}{gap\PYZus{}idx} \PY{o+ow}{in} \PY{n}{gaps}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{n}{gap\PYZus{}mask} \PY{o}{=} \PY{n}{gaps} \PY{o}{==} \PY{n}{gap\PYZus{}idx}
                \PY{n}{gap\PYZus{}size} \PY{o}{=} \PY{n}{gap\PYZus{}mask}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}

                \PY{c+c1}{\PYZsh{} Find values before and after gap}
                \PY{n}{before\PYZus{}idx} \PY{o}{=} \PY{n}{series}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{series}\PY{o}{.}\PY{n}{index} \PY{o}{\PYZlt{}} \PY{n}{gaps}\PY{p}{[}\PY{n}{gap\PYZus{}mask}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{if} \PY{n+nb}{any}\PY{p}{(}\PY{n}{series}\PY{o}{.}\PY{n}{index} \PY{o}{\PYZlt{}} \PY{n}{gaps}\PY{p}{[}\PY{n}{gap\PYZus{}mask}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{else} \PY{k+kc}{None}
                \PY{n}{after\PYZus{}idx} \PY{o}{=} \PY{n}{series}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{series}\PY{o}{.}\PY{n}{index} \PY{o}{\PYZgt{}} \PY{n}{gaps}\PY{p}{[}\PY{n}{gap\PYZus{}mask}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{if} \PY{n+nb}{any}\PY{p}{(}\PY{n}{series}\PY{o}{.}\PY{n}{index} \PY{o}{\PYZgt{}} \PY{n}{gaps}\PY{p}{[}\PY{n}{gap\PYZus{}mask}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{k}{else} \PY{k+kc}{None}

                \PY{k}{if} \PY{n}{before\PYZus{}idx} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None} \PY{o+ow}{and} \PY{n}{after\PYZus{}idx} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} Regular gap with values on both sides}
                    \PY{n}{start\PYZus{}val} \PY{o}{=} \PY{n}{series}\PY{p}{[}\PY{n}{before\PYZus{}idx}\PY{p}{]}
                    \PY{n}{end\PYZus{}val} \PY{o}{=} \PY{n}{series}\PY{p}{[}\PY{n}{after\PYZus{}idx}\PY{p}{]}
                    \PY{n}{gap\PYZus{}values} \PY{o}{=} \PY{p}{[}\PY{n}{start\PYZus{}val} \PY{o}{+} \PY{p}{(}\PY{n}{end\PYZus{}val} \PY{o}{\PYZhy{}} \PY{n}{start\PYZus{}val}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{i} \PY{o}{/} \PY{p}{(}\PY{n}{gap\PYZus{}size} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
                                \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{gap\PYZus{}size} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
                    \PY{n}{result}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{gaps}\PY{p}{[}\PY{n}{gap\PYZus{}mask}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{]} \PY{o}{=} \PY{n}{gap\PYZus{}values}
                \PY{k}{elif} \PY{n}{before\PYZus{}idx} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} Gap at the end \PYZhy{} use last known value}
                    \PY{n}{result}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{gaps}\PY{p}{[}\PY{n}{gap\PYZus{}mask}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{]} \PY{o}{=} \PY{n}{series}\PY{p}{[}\PY{n}{before\PYZus{}idx}\PY{p}{]}
                \PY{k}{elif} \PY{n}{after\PYZus{}idx} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} Gap at the start \PYZhy{} use first known value}
                    \PY{n}{result}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{gaps}\PY{p}{[}\PY{n}{gap\PYZus{}mask}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{]} \PY{o}{=} \PY{n}{series}\PY{p}{[}\PY{n}{after\PYZus{}idx}\PY{p}{]}

            \PY{k}{return} \PY{n}{result}

        \PY{c+c1}{\PYZsh{} Apply custom interpolation to each numeric column}
        \PY{n}{numeric\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Adj Close}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Close}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{High}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Open}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Volume}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{numeric\PYZus{}columns}\PY{p}{:}
            \PY{n}{stock\PYZus{}full}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{interpolate\PYZus{}gaps}\PY{p}{(}\PY{n}{stock\PYZus{}full}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Merge with news data}
        \PY{n}{final\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{stock\PYZus{}full}\PY{p}{,} \PY{n}{news\PYZus{}data}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{how}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Sort by date}
        \PY{n}{final\PYZus{}data} \PY{o}{=} \PY{n}{final\PYZus{}data}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Convert Date back to date (not datetime) for final output}
        \PY{n}{final\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{final\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{date}

        \PY{c+c1}{\PYZsh{} Save the processed data}
        \PY{n}{output\PYZus{}file} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/input/processed/source/}\PY{l+s+si}{\PYZob{}}\PY{n}{ticker}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{.csv}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{final\PYZus{}data}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{output\PYZus{}file}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

        \PY{k}{return} \PY{n}{final\PYZus{}data}

    \PY{k}{except} \PY{n+ne}{FileNotFoundError}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Error: The file }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{input\PYZus{}file}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ was not found.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{k}{return} \PY{k+kc}{None}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{Szentiment értékek}\label{szentiment-uxe9rtuxe9kek}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}sentiment\PYZus{}scores\PYZus{}test}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{news}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Performs sentiment analysis using a specified pipeline and calculates sentiment scores.}

\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        df (pd.DataFrame): DataFrame containing the text data.}
\PY{l+s+sd}{        news (str): Column name for the news headlines or text to analyze.}
\PY{l+s+sd}{        model (str): The model to use for sentiment analysis (\PYZsq{}DistRoBERTa\PYZsq{}, \PYZsq{}FinBERT\PYZsq{}, \PYZsq{}DeBERTa\PYZsq{}).}

\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        pd.DataFrame: DataFrame with calculated sentiment scores.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{c+c1}{\PYZsh{} Create a copy of the DataFrame to avoid SettingWithCopyWarning}
    \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Select the appropriate model pipeline}
    \PY{k}{if} \PY{n}{model} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DistRoBERTa}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
        \PY{n}{sent\PYZus{}pipeline} \PY{o}{=} \PY{n}{\PYZus{}sentiment\PYZus{}analysis\PYZus{}DistRoBERTa}
    \PY{k}{elif} \PY{n}{model} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{FinBERT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
        \PY{n}{sent\PYZus{}pipeline} \PY{o}{=} \PY{n}{\PYZus{}sentiment\PYZus{}analysis\PYZus{}FinBERT}
    \PY{k}{elif} \PY{n}{model} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DeBERTa}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
        \PY{n}{sent\PYZus{}pipeline} \PY{o}{=} \PY{n}{\PYZus{}sentiment\PYZus{}analysis\PYZus{}DeBERTa}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Invalid model name. Choose }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{DistRoBERTa}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{FinBERT}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{DeBERTa}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{n}{res} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
    \PY{n}{fail} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
    \PY{n}{n} \PY{o}{=} \PY{l+m+mi}{0}

    \PY{c+c1}{\PYZsh{} Process each row in the DataFrame}
    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{total}\PY{o}{=}\PY{n+nb}{len}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{,} \PY{n}{disable}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
        \PY{n}{text} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{n}{news}\PY{p}{]}
        \PY{k}{try}\PY{p}{:}
            \PY{k}{if} \PY{n}{pd}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{p}{:}
                \PY{n}{result} \PY{o}{=} \PY{p}{[}\PY{p}{[}
                    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neutral}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{1.0}\PY{p}{\PYZcb{}}\PY{p}{,}
                    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{negative}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{\PYZcb{}}\PY{p}{,}
                    \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{\PYZcb{}}
                \PY{p}{]}\PY{p}{]}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{result} \PY{o}{=} \PY{n}{sent\PYZus{}pipeline}\PY{p}{(}\PY{n}{text}\PY{p}{)}

        \PY{k}{except} \PY{p}{(}\PY{n+ne}{IndexError}\PY{p}{,} \PY{n+ne}{RuntimeError}\PY{p}{)}\PY{p}{:}
            \PY{k}{if} \PY{n}{pd}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{p}{:}
                \PY{n}{fail}\PY{p}{[}\PY{n}{n}\PY{p}{]} \PY{o}{=} \PY{n+nb}{str}\PY{p}{(}\PY{n}{i}\PY{p}{)}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{fail}\PY{p}{[}\PY{n}{n}\PY{p}{]} \PY{o}{=} \PY{n}{text}
                \PY{n}{n} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
            \PY{n}{result} \PY{o}{=} \PY{p}{[}\PY{p}{[}
                \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neutral}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{1.0}\PY{p}{\PYZcb{}}\PY{p}{,}
                \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{negative}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{\PYZcb{}}\PY{p}{,}
                \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{\PYZcb{}}
            \PY{p}{]}\PY{p}{]}
            \PY{k}{pass}
        \PY{n}{res}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{result}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}  \PY{c+c1}{\PYZsh{} Extract the first list}

    \PY{c+c1}{\PYZsh{} Create a new column with the sentiment score}
    \PY{n}{sentiment\PYZus{}score\PYZus{}col} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}sentiment\PYZus{}scores}\PY{l+s+s2}{\PYZdq{}}
    \PY{n}{df}\PY{p}{[}\PY{n}{sentiment\PYZus{}score\PYZus{}col}\PY{p}{]} \PY{o}{=} \PY{n}{res}

    \PY{k}{return} \PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{sentiment\PYZus{}vector}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{scores}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Creates a sentiment vector column based on sentiment scores.}
\PY{l+s+sd}{    (Neutral, Positive, Negative)}

\PY{l+s+sd}{    Parameters:}
\PY{l+s+sd}{    \PYZhy{} df: DataFrame containing the stock data.}
\PY{l+s+sd}{    \PYZhy{} scores: Column name for the sentiment scores.}
\PY{l+s+sd}{    \PYZhy{} model: Name of the model.}
\PY{l+s+sd}{    \PYZhy{} debug: If True, prints debugging information.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Function to extract scores and create a sentiment vector}
    \PY{k}{def} \PY{n+nf}{extract\PYZus{}scores}\PY{p}{(}\PY{n}{row}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} If row is a string, convert it to a Python object}
        \PY{k}{if} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n}{row}\PY{p}{,} \PY{n+nb}{str}\PY{p}{)}\PY{p}{:}
            \PY{n}{row} \PY{o}{=} \PY{n}{ast}\PY{o}{.}\PY{n}{literal\PYZus{}eval}\PY{p}{(}\PY{n}{row}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Safely evaluate the string to a Python object}
        \PY{c+c1}{\PYZsh{} Extract scores for neutral, positive, and negative in the correct order}
        \PY{n}{dimensions} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{item}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:} \PY{n}{item}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{k}{for} \PY{n}{item} \PY{o+ow}{in} \PY{n}{row}\PY{p}{\PYZcb{}}
        \PY{k}{return} \PY{n}{dimensions}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neutral}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{dimensions}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{dimensions}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{negative}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

    \PY{c+c1}{\PYZsh{} Apply the function to the column}
    \PY{n}{sentiment\PYZus{}vector\PYZus{}col} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}sentiment\PYZus{}vector}\PY{l+s+s2}{\PYZdq{}}
    \PY{n}{df}\PY{p}{[}\PY{n}{sentiment\PYZus{}vector\PYZus{}col}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{scores}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{extract\PYZus{}scores}\PY{p}{)}

    \PY{k}{return} \PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{adjust\PYZus{}scores}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{vectors}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Calculate adjusted sentiment scores from vector column.\PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

    \PY{k}{def} \PY{n+nf}{calculate\PYZus{}normalized\PYZus{}score}\PY{p}{(}\PY{n}{vector}\PY{p}{)}\PY{p}{:}
        \PY{n}{neutral}\PY{p}{,} \PY{n}{positive}\PY{p}{,} \PY{n}{negative} \PY{o}{=} \PY{n}{vector}
        \PY{n}{total} \PY{o}{=} \PY{n}{positive} \PY{o}{+} \PY{n}{negative} \PY{c+c1}{\PYZsh{}+ neutral}
        \PY{k}{return} \PY{p}{(}\PY{n}{positive} \PY{o}{\PYZhy{}} \PY{n}{negative}\PY{p}{)} \PY{o}{/} \PY{n}{total} \PY{k}{if} \PY{n}{total} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}

    \PY{k}{def} \PY{n+nf}{calculate\PYZus{}raw\PYZus{}score}\PY{p}{(}\PY{n}{vector}\PY{p}{)}\PY{p}{:}
        \PY{n}{neutral}\PY{p}{,} \PY{n}{positive}\PY{p}{,} \PY{n}{negative} \PY{o}{=} \PY{n}{vector}
        \PY{k}{return} \PY{n}{positive} \PY{k}{if} \PY{n}{positive} \PY{o}{\PYZgt{}} \PY{n}{negative} \PY{k}{else} \PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{negative}\PY{p}{)} \PY{k}{if} \PY{n}{negative} \PY{o}{\PYZgt{}} \PY{n}{positive} \PY{k}{else} \PY{l+m+mi}{0}


    \PY{n}{df}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}adjusted\PYZus{}score}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{vectors}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{calculate\PYZus{}normalized\PYZus{}score}\PY{p}{)}
    \PY{n}{df}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}raw\PYZus{}score}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{vectors}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{calculate\PYZus{}raw\PYZus{}score}\PY{p}{)}

    \PY{k}{return} \PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{Kapott és jósolt adatok
összehasonlítása}\label{kapott-uxe9s-juxf3solt-adatok-uxf6sszehasonluxedtuxe1sa}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{add\PYZus{}trend}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{close}\PY{p}{,} \PY{n}{day}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Calculates the trend of a stock price.}

\PY{l+s+sd}{    Parameters:}
\PY{l+s+sd}{    \PYZhy{} df: DataFrame containing the stock data.}
\PY{l+s+sd}{    \PYZhy{} close: Column name for the close price.}
\PY{l+s+sd}{    \PYZhy{} day: Number of days to calculate the trend.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{k}{try}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} Calculate the trend}
        \PY{n}{tend\PYZus{}col} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trend\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n}{day}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{df}\PY{p}{[}\PY{n}{tend\PYZus{}col}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{close}\PY{p}{]}\PY{o}{.}\PY{n}{pct\PYZus{}change}\PY{p}{(}\PY{n}{periods}\PY{o}{=}\PY{n}{day}\PY{p}{)}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}

        \PY{k}{return} \PY{n}{df}

    \PY{k}{except} \PY{n+ne}{KeyError} \PY{k}{as} \PY{n}{e}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{KeyError: }\PY{l+s+si}{\PYZob{}}\PY{n+nb}{str}\PY{p}{(}\PY{n}{e}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{k}{return} \PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{add\PYZus{}volatility}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{close}\PY{p}{,} \PY{n}{window}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{trading\PYZus{}days}\PY{o}{=}\PY{l+m+mi}{252}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Calculate rolling volatility for a DataFrame\PYZsq{}s close price column.}

\PY{l+s+sd}{    Parameters:}
\PY{l+s+sd}{    \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{l+s+sd}{    df : pandas.DataFrame}
\PY{l+s+sd}{        Input DataFrame containing price data}
\PY{l+s+sd}{    close : str}
\PY{l+s+sd}{        Name of the column containing closing prices}
\PY{l+s+sd}{    window : int, optional}
\PY{l+s+sd}{        Rolling window size for volatility calculation (default: 5)}
\PY{l+s+sd}{    trading\PYZus{}days : int, optional}
\PY{l+s+sd}{        Annual trading days for annualized volatility (default: 252)}

\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{    \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
\PY{l+s+sd}{    pandas.DataFrame}
\PY{l+s+sd}{        Original DataFrame with added volatility columns}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{c+c1}{\PYZsh{} Create a copy of the DataFrame to avoid modifying the original}
    \PY{n}{result} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Calculate log returns}
    \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log\PYZus{}returns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{result}\PY{p}{[}\PY{n}{close}\PY{p}{]} \PY{o}{/} \PY{n}{result}\PY{p}{[}\PY{n}{close}\PY{p}{]}\PY{o}{.}\PY{n}{shift}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Calculate rolling standard deviation of log returns (annualized)}
    \PY{n}{result}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{volatility\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n}{window}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{(}
        \PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log\PYZus{}returns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{n}{window}\PY{p}{)}
        \PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{p}{)}
        \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{trading\PYZus{}days}\PY{p}{)}
    \PY{p}{)}

    \PY{k}{return} \PY{n}{result}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{validate\PYZus{}predictions}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{tar}\PY{p}{,} \PY{n}{sco}\PY{p}{,} \PY{n}{vol}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{n}{score\PYZus{}type}\PY{p}{,} \PY{n}{target\PYZus{}factor}\PY{o}{=}\PY{l+m+mf}{0.15}\PY{p}{,} \PY{n}{score\PYZus{}factor} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Validate prediction based on adaptive volatility\PYZhy{}based threshold for neutrality.}

\PY{l+s+sd}{    Args:}
\PY{l+s+sd}{        df (pd.DataFrame): DataFrame containing stock data with calculated volatility.}
\PY{l+s+sd}{        tar (str): Column name for the target price change (e.g., \PYZsq{}Daily Return\PYZsq{}).}
\PY{l+s+sd}{        sco (str): Column name for the sentiment score.}
\PY{l+s+sd}{        vol (str): Column name for the volatility.}
\PY{l+s+sd}{        model (str): Model name to include in the predictions column.}
\PY{l+s+sd}{        score\PYZus{}type (str): Type of sentiment score (e.g., \PYZsq{}adjusted\PYZsq{}, \PYZsq{}raw\PYZsq{}).}
\PY{l+s+sd}{        target\PYZus{}factor (float): Multiplier for volatility to define the neutral threshold for the target.}
\PY{l+s+sd}{        score\PYZus{}factor (float): Threshold for neutral sentiment score.}

\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{        pd.DataFrame: DataFrame with predictions and success/failure of predictions.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{predict\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

    \PY{c+c1}{\PYZsh{} Validate input columns exist}
    \PY{n}{required\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{n}{tar}\PY{p}{,} \PY{n}{sco}\PY{p}{,} \PY{n}{vol}\PY{p}{]}
    \PY{n}{missing\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{n}{col} \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{required\PYZus{}cols} \PY{k}{if} \PY{n}{col} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{]}
    \PY{k}{if} \PY{n}{missing\PYZus{}cols}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Missing required columns: }\PY{l+s+si}{\PYZob{}}\PY{n}{missing\PYZus{}cols}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Calculate adaptive volatility threshold and predictions}
    \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{total}\PY{o}{=}\PY{n+nb}{len}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{,} \PY{n}{disable}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{:}
        \PY{k}{try}\PY{p}{:}
            \PY{n}{target} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{n}{tar}\PY{p}{]}
            \PY{n}{score} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{n}{sco}\PY{p}{]}

            \PY{c+c1}{\PYZsh{} Handle NaN values}
            \PY{k}{if} \PY{n}{pd}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{n}{target}\PY{p}{)} \PY{o+ow}{or} \PY{n}{pd}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{n}{score}\PY{p}{)} \PY{o+ow}{or} \PY{n}{pd}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{n}{vol}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                \PY{n}{predict\PYZus{}dict}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}  \PY{c+c1}{\PYZsh{} or another default value for NaN cases}
                \PY{k}{continue}


            \PY{n}{neu\PYZus{}target\PYZus{}threshold} \PY{o}{=} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{n}{vol}\PY{p}{]} \PY{o}{*} \PY{n}{target\PYZus{}factor}\PY{p}{)} \PY{k}{if} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{n}{vol}\PY{p}{]} \PY{o}{*} \PY{n}{target\PYZus{}factor}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{1} \PY{k}{else} \PY{l+m+mi}{1} \PY{c+c1}{\PYZsh{} Add abs() for safety}

            \PY{c+c1}{\PYZsh{}neu\PYZus{}score\PYZus{}threshold = abs(row[vol] * score\PYZus{}factor) if abs(row[vol] * score\PYZus{}factor) \PYZlt{}= 1 else 1 \PYZsh{} Add abs() for safety}
            \PY{n}{neu\PYZus{}score\PYZus{}threshold} \PY{o}{=} \PY{n}{score\PYZus{}factor}

            \PY{c+c1}{\PYZsh{} Improved prediction logic}
            \PY{k}{if} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{target}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{n}{neu\PYZus{}target\PYZus{}threshold} \PY{o+ow}{and} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{score}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{n}{neu\PYZus{}score\PYZus{}threshold}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} Only evaluate directional accuracy when both target and score are non\PYZhy{}zero}
                \PY{k}{if} \PY{n}{target} \PY{o}{!=} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{score} \PY{o}{!=} \PY{l+m+mi}{0}\PY{p}{:}
                    \PY{n}{predict\PYZus{}dict}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1} \PY{k}{if} \PY{p}{(}\PY{n}{target} \PY{o}{*} \PY{n}{score}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}  \PY{c+c1}{\PYZsh{} Simplified comparison}
                \PY{k}{else}\PY{p}{:}
                    \PY{n}{predict\PYZus{}dict}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}  \PY{c+c1}{\PYZsh{} Case where either value is zero}
            \PY{k}{else}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} Modified neutral case logic}
                \PY{n}{predict\PYZus{}dict}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1} \PY{k}{if} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{score}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{n}{neu\PYZus{}score\PYZus{}threshold} \PY{o+ow}{and} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{target}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{n}{neu\PYZus{}target\PYZus{}threshold} \PY{k}{else} \PY{l+m+mi}{0}

        \PY{k}{except} \PY{n+ne}{Exception} \PY{k}{as} \PY{n}{e}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{KeyError at index }\PY{l+s+si}{\PYZob{}}\PY{n}{i}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{: }\PY{l+s+si}{\PYZob{}}\PY{n+nb}{str}\PY{p}{(}\PY{n}{e}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{n}{predict\PYZus{}dict}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}

    \PY{c+c1}{\PYZsh{} Create the predictions DataFrame more efficiently}
    \PY{n}{predictions} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{predict\PYZus{}dict}\PY{p}{,} \PY{n}{name}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n}{score\PYZus{}type}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}predictions}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Update the DataFrame more efficiently}
    \PY{k}{if} \PY{n}{predictions}\PY{o}{.}\PY{n}{name} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
        \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{n}{predictions}\PY{o}{.}\PY{n}{name}\PY{p}{]}\PY{p}{)}
    \PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{predictions}\PY{p}{)}

    \PY{k}{return} \PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{Adatok feldolgozása}\label{adatok-feldolgozuxe1sa}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{process\PYZus{}data}\PY{p}{(}\PY{n}{input\PYZus{}file}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{models}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Process stock data}

\PY{l+s+sd}{    Parameters:}
\PY{l+s+sd}{    \PYZhy{} input\PYZus{}file: Path to the input CSV file containing news data}
\PY{l+s+sd}{    \PYZhy{} ticker: Ticker symbol of the stock}
\PY{l+s+sd}{    \PYZhy{} models: Tuple of model names to process.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{preprocess\PYZus{}data}\PY{p}{(}\PY{n}{input\PYZus{}file}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{n}{ticker}\PY{p}{)}

    \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/input/processed/source/}\PY{l+s+si}{\PYZob{}}\PY{n}{ticker}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{n}{data} \PY{o}{=} \PY{n}{add\PYZus{}trend}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Close}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{data} \PY{o}{=} \PY{n}{add\PYZus{}volatility}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Close}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{for} \PY{n}{model} \PY{o+ow}{in} \PY{n}{models}\PY{p}{:}
        \PY{n}{data} \PY{o}{=} \PY{n}{get\PYZus{}sentiment\PYZus{}scores\PYZus{}test}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{News}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{model}\PY{o}{=}\PY{n}{model}\PY{p}{)}
        \PY{n}{data} \PY{o}{=} \PY{n}{sentiment\PYZus{}vector}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}sentiment\PYZus{}scores}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{model}\PY{p}{)}
        \PY{n}{data} \PY{o}{=} \PY{n}{adjust\PYZus{}scores}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}sentiment\PYZus{}vector}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{model}\PY{p}{)}
        \PY{n}{data} \PY{o}{=} \PY{n}{validate\PYZus{}predictions}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{volatility\PYZus{}5d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adjusted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{data} \PY{o}{=} \PY{n}{validate\PYZus{}predictions}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{volatility\PYZus{}5d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{raw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{n}{data}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/output/}\PY{l+s+si}{\PYZob{}}\PY{n}{ticker}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}sentiment.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}

    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DeBERTa Accuracy:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Raw: }\PY{l+s+si}{\PYZob{}}\PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{+w}{ }\PY{o}{/}\PY{+w}{ }\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{,}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Adjusted: }\PY{l+s+si}{\PYZob{}}\PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{+w}{ }\PY{o}{/}\PY{+w}{ }\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{FinBERT Accuracy:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Raw: }\PY{l+s+si}{\PYZob{}}\PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{+w}{ }\PY{o}{/}\PY{+w}{ }\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{,}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Adjusted: }\PY{l+s+si}{\PYZob{}}\PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{+w}{ }\PY{o}{/}\PY{+w}{ }\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DistRoBERTa Accuracy:}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Raw: }\PY{l+s+si}{\PYZob{}}\PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{+w}{ }\PY{o}{/}\PY{+w}{ }\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{,}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Adjusted: }\PY{l+s+si}{\PYZob{}}\PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{+w}{ }\PY{o}{/}\PY{+w}{ }\PY{n+nb}{len}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{k}{return} \PY{n}{data}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{Adatok vizualizálása}\label{adatok-vizualizuxe1luxe1sa}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{create\PYZus{}sentiment\PYZus{}plot}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{data\PYZus{}name}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{:}
    \PY{n}{fig} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Figure}\PY{p}{(}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Define color schemes for each model: (true\PYZus{}color, false\PYZus{}color)}
    \PY{n}{color\PYZus{}schemes} \PY{o}{=} \PY{p}{\PYZob{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}2ecc71}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}a9dfbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} Green shades}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}3498db}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}aed6f1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}      \PY{c+c1}{\PYZsh{} Blue shades}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}9b59b6}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}d7bde2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}       \PY{c+c1}{\PYZsh{} Purple shades}
    \PY{p}{\PYZcb{}}

    \PY{n}{sentiment\PYZus{}models} \PY{o}{=} \PY{p}{[}
        \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
        \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
        \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{p}{]}

    \PY{k}{for} \PY{n}{model\PYZus{}name}\PY{p}{,} \PY{n}{score\PYZus{}col}\PY{p}{,} \PY{n}{pred\PYZus{}col} \PY{o+ow}{in} \PY{n}{sentiment\PYZus{}models}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} Get color scheme for this model}
        \PY{n}{true\PYZus{}color}\PY{p}{,} \PY{n}{false\PYZus{}color} \PY{o}{=} \PY{n}{color\PYZus{}schemes}\PY{p}{[}\PY{n}{model\PYZus{}name}\PY{p}{]}

        \PY{c+c1}{\PYZsh{} Create scatter plot for each prediction value (0 and 1)}
        \PY{k}{for} \PY{n}{pred\PYZus{}value} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:}
            \PY{n}{mask} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{pred\PYZus{}col}\PY{p}{]} \PY{o}{==} \PY{n}{pred\PYZus{}value}

            \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}trace}\PY{p}{(}
                \PY{n}{go}\PY{o}{.}\PY{n}{Scatter}\PY{p}{(}
                    \PY{n}{x}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                    \PY{n}{y}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{n}{mask}\PY{p}{]}\PY{p}{[}\PY{n}{score\PYZus{}col}\PY{p}{]}\PY{p}{,}
                    \PY{n}{name}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ (Prediction=}\PY{l+s+si}{\PYZob{}}\PY{n}{pred\PYZus{}value}\PY{o}{.}\PY{n+nf+fm}{\PYZus{}\PYZus{}bool\PYZus{}\PYZus{}}\PY{p}{(}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                    \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{markers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}  \PY{c+c1}{\PYZsh{} Removed \PYZsq{}lines\PYZsq{} to show only markers}
                    \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}
                        \PY{n}{color}\PY{o}{=}\PY{n}{true\PYZus{}color} \PY{k}{if} \PY{n}{pred\PYZus{}value} \PY{o}{==} \PY{l+m+mi}{1} \PY{k}{else} \PY{n}{false\PYZus{}color}\PY{p}{,}
                        \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,}
                        \PY{n}{symbol}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{circle}\PY{l+s+s1}{\PYZsq{}}
                    \PY{p}{)}
                \PY{p}{)}
            \PY{p}{)}

    \PY{n}{fig}\PY{o}{.}\PY{n}{update\PYZus{}layout}\PY{p}{(}
        \PY{n}{title}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{data\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ Sentiment Scores Over Time by Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{n}{xaxis\PYZus{}title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{n}{yaxis\PYZus{}title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sentiment Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{n}{template}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{plotly\PYZus{}white}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{n}{hovermode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x unified}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
        \PY{n}{legend}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}
            \PY{n}{orientation}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{h}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
            \PY{n}{yanchor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bottom}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
            \PY{n}{y}\PY{o}{=}\PY{l+m+mf}{1.02}\PY{p}{,}
            \PY{n}{xanchor}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{right}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
            \PY{n}{x}\PY{o}{=}\PY{l+m+mi}{1}
        \PY{p}{)}\PY{p}{,}
        \PY{n}{xaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{showgrid}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{,}
        \PY{n}{yaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{showgrid}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{p}{)}
    \PY{n}{fig}\PY{o}{.}\PY{n}{update\PYZus{}traces}\PY{p}{(}\PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{size}\PY{o}{=}\PY{n}{size}\PY{p}{)}\PY{p}{)}
    \PY{k}{return} \PY{n}{fig}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{model\PYZus{}name}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Plot sentiment scores and stock price changes over time.}

\PY{l+s+sd}{    Parameters:}
\PY{l+s+sd}{    \PYZhy{} data: DataFrame containing sentiment and stock data.}
\PY{l+s+sd}{    \PYZhy{} model\PYZus{}name: String, name of the sentiment analysis model (e.g., \PYZsq{}DeBERTa\PYZsq{}).}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}

    \PY{n}{plot\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

    \PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

    \PY{n}{something\PYZus{}unique}\PY{p}{,} \PY{n}{ax1} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Plot adjusted sentiment score moving average}
    \PY{n}{adjusted\PYZus{}score\PYZus{}col} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}adjusted\PYZus{}score\PYZus{}ma}\PY{l+s+s2}{\PYZdq{}}
    \PY{n}{ax1}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{n}{adjusted\PYZus{}score\PYZus{}col}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ Adjusted Score MA}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ Sentiment Scores Over Time by Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Adjusted Sentiment Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax1}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelcolor}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{n}{ax1}\PY{o}{.}\PY{n}{xaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}locator}\PY{p}{(}\PY{n}{plt}\PY{o}{.}\PY{n}{MaxNLocator}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
    \PY{n}{ax1}\PY{o}{.}\PY{n}{xaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{DateFormatter}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{y\PYZhy{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{m\PYZhy{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Add stock price change on secondary y\PYZhy{}axis}
    \PY{n}{ax2} \PY{o}{=} \PY{n}{ax1}\PY{o}{.}\PY{n}{twinx}\PY{p}{(}\PY{p}{)}
    \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{close\PYZus{}diff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Close Price Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Price Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax2}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelcolor}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Add raw sentiment score moving average on another y\PYZhy{}axis}
    \PY{n}{ax3} \PY{o}{=} \PY{n}{ax1}\PY{o}{.}\PY{n}{twinx}\PY{p}{(}\PY{p}{)}
    \PY{n}{raw\PYZus{}score\PYZus{}col} \PY{o}{=} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZus{}raw\PYZus{}score\PYZus{}ma}\PY{l+s+s2}{\PYZdq{}}
    \PY{n}{ax3}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{n}{raw\PYZus{}score\PYZus{}col}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{orange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model\PYZus{}name}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{ Raw Score MA}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax3}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Raw Sentiment Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{orange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ax3}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelcolor}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{orange}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Combine legends}
    \PY{n}{lines1}\PY{p}{,} \PY{n}{labels1} \PY{o}{=} \PY{n}{ax1}\PY{o}{.}\PY{n}{get\PYZus{}legend\PYZus{}handles\PYZus{}labels}\PY{p}{(}\PY{p}{)}
    \PY{n}{lines2}\PY{p}{,} \PY{n}{labels2} \PY{o}{=} \PY{n}{ax2}\PY{o}{.}\PY{n}{get\PYZus{}legend\PYZus{}handles\PYZus{}labels}\PY{p}{(}\PY{p}{)}
    \PY{n}{lines3}\PY{p}{,} \PY{n}{labels3} \PY{o}{=} \PY{n}{ax3}\PY{o}{.}\PY{n}{get\PYZus{}legend\PYZus{}handles\PYZus{}labels}\PY{p}{(}\PY{p}{)}
    \PY{n}{ax1}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{lines1} \PY{o}{+} \PY{n}{lines2} \PY{o}{+} \PY{n}{lines3}\PY{p}{,} \PY{n}{labels1} \PY{o}{+} \PY{n}{labels2} \PY{o}{+} \PY{n}{labels3}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{organize\PYZus{}data\PYZus{}for\PYZus{}plot}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{models}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{stock\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{120}\PY{p}{,} \PY{n}{sentiment\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Organizes the data for plotting.}

\PY{l+s+sd}{    Parameters:}
\PY{l+s+sd}{    \PYZhy{} data: DataFrame containing the data to organize.}
\PY{l+s+sd}{    \PYZhy{} models: Tuple of model names to process.}
\PY{l+s+sd}{    \PYZhy{} stock\PYZus{}window: Rolling window size for stock prices.}
\PY{l+s+sd}{    \PYZhy{} sentiment\PYZus{}window: Rolling window size for sentiment scores.}
\PY{l+s+sd}{    \PYZhy{} resample: Resampling frequency (e.g., \PYZsq{}D\PYZsq{} for daily).}

\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{    \PYZhy{} DataFrame organized for plotting.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{c+c1}{\PYZsh{} Create a copy of the data}
    \PY{n}{plot\PYZus{}data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Ensure the \PYZsq{}Date\PYZsq{} column is converted to datetime if it exists}
    \PY{k}{if} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
        \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{errors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{coerce}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Set \PYZsq{}Date\PYZsq{} as the index}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{raise} \PY{n+ne}{ValueError}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The DataFrame must contain a }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{Date}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ column.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Drop unnecessary columns}
    \PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{High}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Open}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Volume}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Adj Close}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{News}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log\PYZus{}returns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{errors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Drop model\PYZhy{}specific columns}
    \PY{k}{for} \PY{n}{model} \PY{o+ow}{in} \PY{n}{models}\PY{p}{:}
        \PY{n}{model\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}sentiment\PYZus{}scores}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}sentiment\PYZus{}vector}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{model\PYZus{}columns}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{errors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Resample the data and interpolate missing values}
    \PY{n}{plot\PYZus{}data} \PY{o}{=} \PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{n}{resample}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
    \PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{interpolate}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Calculate rolling averages for sentiment scores}
    \PY{k}{for} \PY{n}{model} \PY{o+ow}{in} \PY{n}{models}\PY{p}{:}
        \PY{k}{if} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
            \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}adjusted\PYZus{}score\PYZus{}ma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{n}{sentiment\PYZus{}window}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
        \PY{k}{if} \PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
            \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}raw\PYZus{}score\PYZus{}ma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{n}{sentiment\PYZus{}window}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Calculate rolling averages and differences for stock prices}
    \PY{k}{if} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Close}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{plot\PYZus{}data}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
        \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{close\PYZus{}ma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Close}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{n}{stock\PYZus{}window}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
        \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{close\PYZus{}diff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Close}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{plot\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{close\PYZus{}ma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

    \PY{k}{return} \PY{n}{plot\PYZus{}data}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{Visszatesztelés}\label{visszateszteluxe9s}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{process\PYZus{}sentiment\PYZus{}data}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{n}{score\PYZus{}type}\PY{p}{,} \PY{n}{window}\PY{p}{,} \PY{n}{resample}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Parameters:}
\PY{l+s+sd}{    \PYZhy{} data: DataFrame containing the sentiment data.}
\PY{l+s+sd}{    \PYZhy{} model: Name of the model.}
\PY{l+s+sd}{    \PYZhy{} score\PYZus{}type: Type of sentiment score (e.g., \PYZsq{}adjusted\PYZsq{}, \PYZsq{}raw\PYZsq{}).}
\PY{l+s+sd}{    \PYZhy{} window: Size of the rolling window for calculating the mean and rolling average.}
\PY{l+s+sd}{    \PYZhy{} resample: Resampling frequency (e.g., \PYZsq{}D\PYZsq{} for daily).}

\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{    \PYZhy{} processed\PYZus{}df: DataFrame with processed sentiment data.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{c+c1}{\PYZsh{} Convert the string representation of list to actual list and extract positive sentiment}
    \PY{n}{df} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
    \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sentiment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{model}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}}\PY{l+s+si}{\PYZob{}}\PY{n}{score\PYZus{}type}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

    \PY{c+c1}{\PYZsh{} Select and rename required columns}
    \PY{n}{processed\PYZus{}df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Close}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{High}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Open}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Volume}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sentiment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
    \PY{n}{processed\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{processed\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
    \PY{n}{processed\PYZus{}df}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{n}{processed\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sentiment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{processed\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sentiment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{resample}\PY{p}{(}\PY{n}{resample}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
    \PY{n}{processed\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sentiment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{processed\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sentiment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{n}{window}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
    \PY{n}{processed\PYZus{}df}\PY{o}{.}\PY{n}{interpolate}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{n}{processed\PYZus{}df}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
    \PY{k}{return} \PY{n}{processed\PYZus{}df}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{class} \PY{n+nc}{PandasSent}\PY{p}{(}\PY{n}{bt}\PY{o}{.}\PY{n}{feeds}\PY{o}{.}\PY{n}{PandasData}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Custom PandasData feed for backtesting.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{lines} \PY{o}{=} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sentiment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{p}{)}
    \PY{n}{params} \PY{o}{=} \PY{p}{(}
        \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{k+kc}{None}\PY{p}{)}\PY{p}{,}
        \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{open}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Open}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
        \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{high}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{High}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
        \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
        \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{close}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Close}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
        \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{volume}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Volume}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
        \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sentiment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sentiment}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{run\PYZus{}backtest}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{model}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{score\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{raw}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{window}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Parameters:}
\PY{l+s+sd}{    \PYZhy{} df: DataFrame containing the sentiment data.}
\PY{l+s+sd}{    \PYZhy{} model: Name of the model.}
\PY{l+s+sd}{    \PYZhy{} score\PYZus{}type: Type of sentiment score (e.g., \PYZsq{}adjusted\PYZsq{}, \PYZsq{}raw\PYZsq{}).}
\PY{l+s+sd}{    \PYZhy{} window: Size of the rolling window for calculating the mean and rolling average.}
\PY{l+s+sd}{    \PYZhy{} resample: Resampling frequency (e.g., \PYZsq{}D\PYZsq{} for daily). Default is \PYZsq{}D\PYZsq{}.}

\PY{l+s+sd}{    Returns:}
\PY{l+s+sd}{    \PYZhy{} results: Backtest results.}
\PY{l+s+sd}{    \PYZhy{} cerebro: Backtesting cerebro.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{processed\PYZus{}data} \PY{o}{=} \PY{n}{process\PYZus{}sentiment\PYZus{}data}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{n}{score\PYZus{}type}\PY{p}{,} \PY{n}{window}\PY{p}{,} \PY{n}{resample}\PY{p}{)}
    \PY{n}{data\PYZus{}feed} \PY{o}{=} \PY{n}{PandasSent}\PY{p}{(}\PY{n}{dataname}\PY{o}{=}\PY{n}{processed\PYZus{}data}\PY{p}{)}
    \PY{n}{cerebro} \PY{o}{=} \PY{n}{bt}\PY{o}{.}\PY{n}{Cerebro}\PY{p}{(}\PY{p}{)}
    \PY{n}{cerebro}\PY{o}{.}\PY{n}{addstrategy}\PY{p}{(}\PY{n}{SentimentStrategy}\PY{p}{)}
    \PY{n}{cerebro}\PY{o}{.}\PY{n}{adddata}\PY{p}{(}\PY{n}{data\PYZus{}feed}\PY{p}{)}
    \PY{n}{cerebro}\PY{o}{.}\PY{n}{broker}\PY{o}{.}\PY{n}{setcash}\PY{p}{(}\PY{l+m+mf}{100000.0}\PY{p}{)}
    \PY{n}{cerebro}\PY{o}{.}\PY{n}{broker}\PY{o}{.}\PY{n}{setcommission}\PY{p}{(}\PY{n}{commission}\PY{o}{=}\PY{l+m+mf}{0.01}\PY{p}{)}  \PY{c+c1}{\PYZsh{} 0.1\PYZpc{} commission}
    \PY{n}{cerebro}\PY{o}{.}\PY{n}{addanalyzer}\PY{p}{(}\PY{n}{bt}\PY{o}{.}\PY{n}{analyzers}\PY{o}{.}\PY{n}{PyFolio}\PY{p}{,} \PY{n}{\PYZus{}name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PyFolio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{start\PYZus{}value} \PY{o}{=} \PY{n}{cerebro}\PY{o}{.}\PY{n}{broker}\PY{o}{.}\PY{n}{getvalue}\PY{p}{(}\PY{p}{)}
    \PY{n}{results} \PY{o}{=} \PY{n}{cerebro}\PY{o}{.}\PY{n}{run}\PY{p}{(}\PY{p}{)}
    \PY{n}{final\PYZus{}value} \PY{o}{=} \PY{n}{cerebro}\PY{o}{.}\PY{n}{broker}\PY{o}{.}\PY{n}{getvalue}\PY{p}{(}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Starting Portfolio Value: }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{start\PYZus{}value}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Final Portfolio Value: }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{final\PYZus{}value}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Return: }\PY{l+s+si}{\PYZpc{}.2f}\PY{l+s+si}{\PYZpc{}\PYZpc{}}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{p}{(}\PY{n}{final\PYZus{}value} \PY{o}{\PYZhy{}} \PY{n}{start\PYZus{}value}\PY{p}{)} \PY{o}{/} \PY{n}{start\PYZus{}value} \PY{o}{*} \PY{l+m+mi}{100}\PY{p}{)}\PY{p}{)}

    \PY{k}{return} \PY{n}{results}\PY{p}{,} \PY{n}{cerebro}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{class} \PY{n+nc}{SentimentStrategy}\PY{p}{(}\PY{n}{bt}\PY{o}{.}\PY{n}{Strategy}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Custom strategy for backtesting.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{params} \PY{o}{=} \PY{p}{(}
        \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{exitbars}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{)}\PY{p}{,}
    \PY{p}{)}

    \PY{k}{def} \PY{n+nf}{log}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{txt}\PY{p}{,} \PY{n}{dt}\PY{o}{=}\PY{k+kc}{None}\PY{p}{)}\PY{p}{:}
        \PY{n}{dt} \PY{o}{=} \PY{n}{dt} \PY{o+ow}{or} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{datas}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{datetime}\PY{o}{.}\PY{n}{date}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}}\PY{n}{dt}\PY{o}{.}\PY{n}{isoformat}\PY{p}{(}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{: }\PY{l+s+si}{\PYZob{}}\PY{n}{txt}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dataclose} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{datas}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{close}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{datasentiment} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{datas}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{sentiment}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{order} \PY{o}{=} \PY{k+kc}{None}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{buyprice} \PY{o}{=} \PY{k+kc}{None}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{buycomm} \PY{o}{=} \PY{k+kc}{None}

    \PY{k}{def} \PY{n+nf}{notify\PYZus{}order}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{order}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n}{order}\PY{o}{.}\PY{n}{status} \PY{o+ow}{in} \PY{p}{[}\PY{n}{order}\PY{o}{.}\PY{n}{Submitted}\PY{p}{,} \PY{n}{order}\PY{o}{.}\PY{n}{Accepted}\PY{p}{]}\PY{p}{:}
            \PY{k}{return}

        \PY{k}{if} \PY{n}{order}\PY{o}{.}\PY{n}{status} \PY{o+ow}{in} \PY{p}{[}\PY{n}{order}\PY{o}{.}\PY{n}{Completed}\PY{p}{]}\PY{p}{:}
            \PY{k}{if} \PY{n}{order}\PY{o}{.}\PY{n}{isbuy}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{log}\PY{p}{(}
                    \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{BUY EXECUTED, Price: }\PY{l+s+si}{\PYZob{}}\PY{n}{order}\PY{o}{.}\PY{n}{executed}\PY{o}{.}\PY{n}{price}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}}
                    \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Cost: }\PY{l+s+si}{\PYZob{}}\PY{n}{order}\PY{o}{.}\PY{n}{executed}\PY{o}{.}\PY{n}{value}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}}
                    \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Comm: }\PY{l+s+si}{\PYZob{}}\PY{n}{order}\PY{o}{.}\PY{n}{executed}\PY{o}{.}\PY{n}{comm}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}
                \PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{buyprice} \PY{o}{=} \PY{n}{order}\PY{o}{.}\PY{n}{executed}\PY{o}{.}\PY{n}{price}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{buycomm} \PY{o}{=} \PY{n}{order}\PY{o}{.}\PY{n}{executed}\PY{o}{.}\PY{n}{comm}
            \PY{k}{else}\PY{p}{:}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{log}\PY{p}{(}
                    \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{SELL EXECUTED, Price: }\PY{l+s+si}{\PYZob{}}\PY{n}{order}\PY{o}{.}\PY{n}{executed}\PY{o}{.}\PY{n}{price}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}}
                    \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Cost: }\PY{l+s+si}{\PYZob{}}\PY{n}{order}\PY{o}{.}\PY{n}{executed}\PY{o}{.}\PY{n}{value}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}}
                    \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Comm: }\PY{l+s+si}{\PYZob{}}\PY{n}{order}\PY{o}{.}\PY{n}{executed}\PY{o}{.}\PY{n}{comm}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}
                \PY{p}{)}

            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bar\PYZus{}executed} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}

        \PY{k}{elif} \PY{n}{order}\PY{o}{.}\PY{n}{status} \PY{o+ow}{in} \PY{p}{[}\PY{n}{order}\PY{o}{.}\PY{n}{Canceled}\PY{p}{,} \PY{n}{order}\PY{o}{.}\PY{n}{Margin}\PY{p}{,} \PY{n}{order}\PY{o}{.}\PY{n}{Rejected}\PY{p}{]}\PY{p}{:}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Order Canceled/Margin/Rejected}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{order} \PY{o}{=} \PY{k+kc}{None}

    \PY{k}{def} \PY{n+nf}{notify\PYZus{}trade}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{trade}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{o+ow}{not} \PY{n}{trade}\PY{o}{.}\PY{n}{isclosed}\PY{p}{:}
            \PY{k}{return}

        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{OPERATION PROFIT, GROSS: }\PY{l+s+si}{\PYZob{}}\PY{n}{trade}\PY{o}{.}\PY{n}{pnl}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, NET: }\PY{l+s+si}{\PYZob{}}\PY{n}{trade}\PY{o}{.}\PY{n}{pnlcomm}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{k}{def} \PY{n+nf}{next}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Close: }\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dataclose}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, Sentiment: }\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{datasentiment}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s2}{.3f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

        \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{order}\PY{p}{:}
            \PY{k}{return}

        \PY{k}{if} \PY{o+ow}{not} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{position}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} Modified condition to use positive sentiment as buy signal}
            \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{datasentiment}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mf}{0.1}\PY{p}{:}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BUY CREATE, }\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dataclose}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{order} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{buy}\PY{p}{(}\PY{n}{size}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{datasentiment}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{l+m+mi}{10000}\PY{p}{)}
            \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{datasentiment}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{o}{\PYZhy{}}\PY{l+m+mi}{6}\PY{p}{:}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BUY CREATE, }\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dataclose}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{order} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{buy}\PY{p}{(}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{10000}\PY{p}{)}

        \PY{k}{else}\PY{p}{:}
            \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{datasentiment}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o+ow}{and} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bar\PYZus{}executed} \PY{o}{+} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{params}\PY{o}{.}\PY{n}{exitbars}\PY{p}{)}\PY{p}{:}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SELL CREATE, }\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dataclose}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{l+s+si}{:}\PY{l+s+s1}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{order} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sell}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{class} \PY{n+nc}{CustomPlotter}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Custom plotter for backtesting.}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{cerebro\PYZus{}instance}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{cerebro} \PY{o}{=} \PY{n}{cerebro\PYZus{}instance}

    \PY{k}{def} \PY{n+nf}{plot\PYZus{}results}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
\PY{+w}{        }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{        Plot the cerebro trading results including:}
\PY{l+s+sd}{        \PYZhy{} Price and sentiment data}
\PY{l+s+sd}{        \PYZhy{} Portfolio value over time}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{c+c1}{\PYZsh{} Get the first strategy from the cerebro}
        \PY{n}{strategy} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{cerebro}\PY{o}{.}\PY{n}{runstrats}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}

        \PY{c+c1}{\PYZsh{} Create figure and axis objects with a single subplot}
        \PY{n}{fig}\PY{p}{,} \PY{p}{(}\PY{n}{ax1}\PY{p}{,} \PY{n}{ax2}\PY{p}{)} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{height\PYZus{}ratios}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Get the data from the data feed}
        \PY{n}{datas} \PY{o}{=} \PY{n}{strategy}\PY{o}{.}\PY{n}{datas}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}

        \PY{c+c1}{\PYZsh{} Convert dates to list for x\PYZhy{}axis}
        \PY{n}{dates} \PY{o}{=} \PY{p}{[}\PY{n}{bt}\PY{o}{.}\PY{n}{num2date}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{datas}\PY{o}{.}\PY{n}{lines}\PY{o}{.}\PY{n}{datetime}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}\PY{p}{]}

        \PY{c+c1}{\PYZsh{} Plot close prices}
        \PY{n}{ax1}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{dates}\PY{p}{,} \PY{n}{datas}\PY{o}{.}\PY{n}{lines}\PY{o}{.}\PY{n}{close}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Close Price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MSFT Price and Trading Activity}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{ax1}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{ax1}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Plot sentiment scores if available}
        \PY{k}{if} \PY{n+nb}{hasattr}\PY{p}{(}\PY{n}{datas}\PY{o}{.}\PY{n}{lines}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{deberta\PYZus{}sentiment\PYZus{}scores}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
            \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{dates}\PY{p}{,} \PY{n}{datas}\PY{o}{.}\PY{n}{lines}\PY{o}{.}\PY{n}{deberta\PYZus{}sentiment\PYZus{}scores}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}\PY{p}{,}
                    \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sentiment Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sentiment Scores}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{ax2}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
            \PY{n}{ax2}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Format x\PYZhy{}axis}
        \PY{k}{for} \PY{n}{ax} \PY{o+ow}{in} \PY{p}{[}\PY{n}{ax1}\PY{p}{,} \PY{n}{ax2}\PY{p}{]}\PY{p}{:}
            \PY{n}{ax}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Add buy/sell markers if available in the strategy}
        \PY{k}{if} \PY{n+nb}{hasattr}\PY{p}{(}\PY{n}{strategy}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{buy\PYZus{}points}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o+ow}{and} \PY{n+nb}{hasattr}\PY{p}{(}\PY{n}{strategy}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sell\PYZus{}points}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
            \PY{k}{for} \PY{n}{point} \PY{o+ow}{in} \PY{n}{strategy}\PY{o}{.}\PY{n}{buy\PYZus{}points}\PY{p}{:}
                \PY{n}{ax1}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{bt}\PY{o}{.}\PY{n}{num2date}\PY{p}{(}\PY{n}{point}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{point}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZca{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{markersize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Buy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{k}{for} \PY{n}{point} \PY{o+ow}{in} \PY{n}{strategy}\PY{o}{.}\PY{n}{sell\PYZus{}points}\PY{p}{:}
                \PY{n}{ax1}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{bt}\PY{o}{.}\PY{n}{num2date}\PY{p}{(}\PY{n}{point}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{point}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{v}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                        \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{markersize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sell}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Adjust layout and display}
        \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
        \PY{k}{return} \PY{n}{fig}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{plot\PYZus{}backtest}\PY{p}{(}\PY{n}{cerebro\PYZus{}instance}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Wrapper function to create and show the plot}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{plotter} \PY{o}{=} \PY{n}{CustomPlotter}\PY{p}{(}\PY{n}{cerebro\PYZus{}instance}\PY{p}{)}
    \PY{n}{fig} \PY{o}{=} \PY{n}{plotter}\PY{o}{.}\PY{n}{plot\PYZus{}results}\PY{p}{(}\PY{p}{)}
    \PY{k}{return} \PY{n}{fig}
\end{Verbatim}
\end{tcolorbox}

    \subsection{Szentiment Vizsgálat}\label{szentiment-vizsguxe1lat}

    \subsubsection{NVDA}\label{nvda}

    \paragraph{Process Data}\label{process-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NVDA\PYZus{}data} \PY{o}{=} \PY{n}{process\PYZus{}data}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/input/raw/source/analyst\PYZus{}ratings\PYZus{}processed.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{NVDA}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Plot Data}\label{plot-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NVDA\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Close}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NVDA\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trend\PYZus{}1d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NVDA\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{volatility\PYZus{}5d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NVDA\PYZus{}plot\PYZus{}data} \PY{o}{=} \PY{n}{organize\PYZus{}data\PYZus{}for\PYZus{}plot}\PY{p}{(}\PY{n}{NVDA\PYZus{}data}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sentiment\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{stock\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{NVDA\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{NVDA\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{NVDA\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Correlation}\label{correlation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NVDA\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NVDA\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NVDA\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{NVDA\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{O}\label{o}

    \paragraph{Process Data}\label{process-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{O\PYZus{}data} \PY{o}{=} \PY{n}{process\PYZus{}data}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/input/raw/source/analyst\PYZus{}ratings\PYZus{}processed.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{O}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Plot Data}\label{plot-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{O\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Close}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{O\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trend\PYZus{}1d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{O\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{volatility\PYZus{}5d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{O\PYZus{}plot\PYZus{}data} \PY{o}{=} \PY{n}{organize\PYZus{}data\PYZus{}for\PYZus{}plot}\PY{p}{(}\PY{n}{O\PYZus{}data}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sentiment\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{stock\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{O\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{O\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{O\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Correlation}\label{correlation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{O\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{O\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{O\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{O\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{MU}\label{mu}

    \paragraph{Process Data}\label{process-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MU\PYZus{}data} \PY{o}{=} \PY{n}{process\PYZus{}data}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/input/raw/source/analyst\PYZus{}ratings\PYZus{}processed.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MU}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Plot Data}\label{plot-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MU\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Close}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MU\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trend\PYZus{}1d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MU\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{volatility\PYZus{}5d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MU\PYZus{}plot\PYZus{}data} \PY{o}{=} \PY{n}{organize\PYZus{}data\PYZus{}for\PYZus{}plot}\PY{p}{(}\PY{n}{MU\PYZus{}data}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sentiment\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{stock\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MU\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MU\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MU\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Correlation}\label{correlation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MU\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MU\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MU\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MU\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{MS}\label{ms}

    \paragraph{Process Data}\label{process-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MS\PYZus{}data} \PY{o}{=} \PY{n}{process\PYZus{}data}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/input/raw/source/analyst\PYZus{}ratings\PYZus{}processed.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MS}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Plot Data}\label{plot-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MS\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Close}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MS\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trend\PYZus{}1d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MS\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{volatility\PYZus{}5d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MS\PYZus{}plot\PYZus{}data} \PY{o}{=} \PY{n}{organize\PYZus{}data\PYZus{}for\PYZus{}plot}\PY{p}{(}\PY{n}{MS\PYZus{}data}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sentiment\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{stock\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MS\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MS\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MS\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Correlation}\label{correlation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MS\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MS\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MS\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MS\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{GOOG}\label{goog}

    \paragraph{Process Data}\label{process-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{GOOG\PYZus{}data} \PY{o}{=} \PY{n}{process\PYZus{}data}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/input/raw/source/analyst\PYZus{}ratings\PYZus{}processed.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GOOG}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Plot Data}\label{plot-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{GOOG\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Close}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{GOOG\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trend\PYZus{}1d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{GOOG\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{volatility\PYZus{}5d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{GOOG\PYZus{}plot\PYZus{}data} \PY{o}{=} \PY{n}{organize\PYZus{}data\PYZus{}for\PYZus{}plot}\PY{p}{(}\PY{n}{GOOG\PYZus{}data}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sentiment\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{stock\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{GOOG\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{GOOG\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{GOOG\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Correlation}\label{correlation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{GOOG\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{GOOG\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{GOOG\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{GOOG\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{MRK}\label{mrk}

    \paragraph{Process Data}\label{process-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MRK\PYZus{}data} \PY{o}{=} \PY{n}{process\PYZus{}data}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/input/raw/source/analyst\PYZus{}ratings\PYZus{}processed.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MRK}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Plot Data}\label{plot-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MRK\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Close}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MRK\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trend\PYZus{}1d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MRK\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{volatility\PYZus{}5d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MRK\PYZus{}plot\PYZus{}data} \PY{o}{=} \PY{n}{organize\PYZus{}data\PYZus{}for\PYZus{}plot}\PY{p}{(}\PY{n}{MRK\PYZus{}data}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sentiment\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{stock\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MRK\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MRK\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MRK\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Correlation}\label{correlation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MRK\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MRK\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MRK\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MRK\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{QQQ}\label{qqq}

    \paragraph{Process Data}\label{process-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{QQQ\PYZus{}data} \PY{o}{=} \PY{n}{process\PYZus{}data}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/input/raw/source/analyst\PYZus{}ratings\PYZus{}processed.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{QQQ}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Plot Data}\label{plot-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{QQQ\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Close}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{QQQ\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trend\PYZus{}1d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{QQQ\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{volatility\PYZus{}5d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{QQQ\PYZus{}plot\PYZus{}data} \PY{o}{=} \PY{n}{organize\PYZus{}data\PYZus{}for\PYZus{}plot}\PY{p}{(}\PY{n}{QQQ\PYZus{}data}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sentiment\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{stock\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{QQQ\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{QQQ\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{QQQ\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Correlation}\label{correlation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{QQQ\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{QQQ\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{QQQ\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{QQQ\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{MSFT}\label{msft}

    \paragraph{Process Data}\label{process-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSFT\PYZus{}data} \PY{o}{=} \PY{n}{process\PYZus{}data}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/input/raw/source/MicrosoftNews.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MSFT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Plot Data}\label{plot-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSFT\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Close}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSFT\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trend\PYZus{}1d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSFT\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{volatility\PYZus{}5d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSFT\PYZus{}plot\PYZus{}data} \PY{o}{=} \PY{n}{organize\PYZus{}data\PYZus{}for\PYZus{}plot}\PY{p}{(}\PY{n}{MSFT\PYZus{}data}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sentiment\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{stock\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MSFT\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MSFT\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{MSFT\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Correlation}\label{correlation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSFT\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSFT\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSFT\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MSFT\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{AAPL}\label{aapl}

    \paragraph{Process Data}\label{process-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{AAPL\PYZus{}data} \PY{o}{=} \PY{n}{process\PYZus{}data}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/input/raw/source/AAPL.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ticker}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AAPL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Plot Data}\label{plot-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{AAPL\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Close}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{AAPL\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{trend\PYZus{}1d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{AAPL\PYZus{}data}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{line}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{volatility\PYZus{}5d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Date}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{22}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{AAPL\PYZus{}plot\PYZus{}data} \PY{o}{=} \PY{n}{organize\PYZus{}data\PYZus{}for\PYZus{}plot}\PY{p}{(}\PY{n}{AAPL\PYZus{}data}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sentiment\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{stock\PYZus{}window}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{AAPL\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{AAPL\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plot\PYZus{}sentiment\PYZus{}and\PYZus{}stock}\PY{p}{(}\PY{n}{AAPL\PYZus{}plot\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{Correlation}\label{correlation}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{AAPL\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{AAPL\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}adjusted\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{AAPL\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{AAPL\PYZus{}data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FinBERT\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DistRoBERTa\PYZus{}raw\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trend\PYZus{}1d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{rolling}\PY{p}{(}\PY{n}{window}\PY{o}{=}\PY{l+m+mi}{28}\PY{p}{,} \PY{n}{center}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsection{TO DO}\label{to-do}

Histogram Equalization 3d megbízhatóság számolás

    \subsubsection{Plot Sentiment Scores}\label{plot-sentiment-scores}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{aapl\PYZus{}fig} \PY{o}{=} \PY{n}{create\PYZus{}sentiment\PYZus{}plot}\PY{p}{(}\PY{n}{AAPL\PYZus{}data}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Apple}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n}{aapl\PYZus{}fig}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{msft\PYZus{}fig} \PY{o}{=} \PY{n}{create\PYZus{}sentiment\PYZus{}plot}\PY{p}{(}\PY{n}{MSFT\PYZus{}data}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Microsoft}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n}{msft\PYZus{}fig}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsection{Visszatesztelés}\label{visszateszteluxe9s}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{MU\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/tmp/pycharm\PYZus{}project\PYZus{}520/src/data/output/MU\PYZus{}sentiment.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{results}\PY{p}{,} \PY{n}{cerebro} \PY{o}{=} \PY{n}{run\PYZus{}backtest}\PY{p}{(}\PY{n}{MS\PYZus{}data}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DeBERTa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adjusted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{window}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{,} \PY{n}{resample}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{fig} \PY{o}{=} \PY{n}{plot\PYZus{}backtest}\PY{p}{(}\PY{n}{cerebro}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \section{Összefoglalás}\label{uxf6sszefoglaluxe1s}

    \section{Summary}\label{summary}

    \section{Irodalomjegyzék}\label{irodalomjegyzuxe9k}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
